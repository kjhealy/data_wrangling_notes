<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ab006101b7430f837520e76e9991ac05.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.37">

  <meta name="author" content="Kieran Healy">
  <meta name="dcterms.date" content="2024-10-07">
  <title>Data Wrangling with R and the Tidyverse – Manipulating tables with dplyr</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f5bde6; background-color: #24273a; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #cad3f5; } /* Normal */
    code span.al { color: #ed8796; font-weight: bold; } /* Alert */
    code span.an { color: #eed49f; } /* Annotation */
    code span.at { color: #b7bdf8; } /* Attribute */
    code span.bn { color: #ed8796; } /* BaseN */
    code span.bu { color: #ed8796; } /* BuiltIn */
    code span.cf { color: #c6a0f6; } /* ControlFlow */
    code span.ch { color: #f5bde6; } /* Char */
    code span.cn { color: #8aadf4; } /* Constant */
    code span.co { color: #6e738d; font-style: italic; } /* Comment */
    code span.cv { color: #6e738d; font-style: italic; } /* CommentVar */
    code span.do { color: #ed8796; } /* Documentation */
    code span.dt { color: #c6a0f6; } /* DataType */
    code span.dv { color: #f5a97f; } /* DecVal */
    code span.er { color: #ed8796; text-decoration: underline; } /* Error */
    code span.ex { color: #8aadf4; } /* Extension */
    code span.fl { color: #f5a97f; } /* Float */
    code span.fu { color: #8aadf4; } /* Function */
    code span.im { color: #a6da95; } /* Import */
    code span.in { color: #f5a97f; } /* Information */
    code span.kw { color: #c6a0f6; } /* Keyword */
    code span.op { color: #91d7e3; } /* Operator */
    code span.ot { color: #f5a97f; } /* Other */
    code span.pp { color: #f5bde6; } /* Preprocessor */
    code span.re { color: #6e738d; font-style: italic; } /* RegionMarker */
    code span.sc { color: #f5bde6; } /* SpecialChar */
    code span.ss { color: #ed8796; } /* SpecialString */
    code span.st { color: #a6da95; } /* String */
    code span.va { color: #f5bde6; } /* Variable */
    code span.vs { color: #ed8796; } /* VerbatimString */
    code span.wa { color: #f5a97f; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-d821f746f1112e15bc8fd593da8fbad9.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#252F3E" class="quarto-title-block center">
  <h1 class="title">Manipulating tables with <code>dplyr</code></h1>
  <p class="subtitle">Data Wrangling, Session 3</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Kieran Healy 
</div>
        <p class="quarto-title-affiliation">
            Code Horizons
          </p>
    </div>
</div>

  <p class="date">October 7, 2024</p>
</section>
<section>
<section id="dplyr-is-your-toolkit-for-tabular-data" class="title-slide slide level1 inv-title center" data-background-color="#252F3E">
<h1><span class="fg-lblue">dplyr</span> is your toolkit for tabular data</h1>

</section>
<section class="slide level2">

<div class="huge">
<p>So let’s<br>play with<br>some <span class="fg-red">data</span></p>
</div>

<aside><div>
<p>woohoo!</p>
</div></aside></section>
<section id="load-our-libraries" class="slide level2">
<h2>Load our libraries</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)      <span class="co"># manage file paths</span></span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(socviz)    <span class="co"># data and some useful functions</span></span>
<span id="cb1-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># your friend and mine</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tidyverse-components-again" class="slide level2">
<h2>Tidyverse components, again</h2>
<div class="columns">
<div class="column" style="width:55%;">
<ul>
<li><span class="fg-green"><strong><code>library</code></strong></span><code>(tidyverse)</code></li>
<li><code>Loading tidyverse: ggplot2</code></li>
<li><code>Loading tidyverse: tibble</code></li>
<li><code>Loading tidyverse: tidyr</code></li>
<li><code>Loading tidyverse: readr</code></li>
<li><code>Loading tidyverse: purrr</code></li>
<li><code>Loading tidyverse: dplyr</code></li>
</ul>
</div><div class="column left" style="width:45%;">
<ul>
<li>Call the package and …</li>
<li><code>&lt;|</code> <strong>Draw graphs</strong></li>
<li><code>&lt;|</code> <strong>Nicer data tables</strong></li>
<li><code>&lt;|</code> <strong>Tidy your data</strong></li>
<li><code>&lt;|</code> <strong>Get data into R</strong></li>
<li><code>&lt;|</code> <strong>Fancy Iteration</strong></li>
<li><code>&lt;|</code> <strong>Action verbs for tables</strong></li>
</ul>
</div></div>
</section>
<section id="other-tidyverse-components" class="slide level2">
<h2>Other tidyverse components</h2>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li><code>forcats</code></li>
<li><code>haven</code></li>
<li><code>lubridate</code></li>
<li><code>readxl</code></li>
<li><code>stringr</code></li>
<li><code>reprex</code></li>
</ul>
</div><div class="column left" style="width:60%;">
<ul>
<li><code>&lt;|</code> <strong>Deal with factors</strong></li>
<li><code>&lt;|</code> <strong>Import Stata, SPSS, etc</strong></li>
<li><code>&lt;|</code> <strong>Dates, Durations, Times</strong></li>
<li><code>&lt;|</code> <strong>Import from spreadsheets</strong></li>
<li><code>&lt;|</code> <strong>Strings and Regular Expressions</strong></li>
<li><code>&lt;|</code> <strong>Make reproducible examples</strong></li>
</ul>
</div></div>
<div class="fragment" data-fragment-index="1">
<p>Not all of these are attached when we do <code>library(tidyverse)</code></p>
</div>
</section>
<section id="dplyr-lets-you-work-with-tibbles" class="slide level2">
<h2><span class="fg-yellow">dplyr</span> lets you work with tibbles</h2>
<div class="fragment" data-fragment-index="1">
<ul>
<li>Remember, tibbles are tables of data where the columns can be of different types, such as numeric, logical, character, factor, etc.</li>
<li>We’ll use dplyr to <em>transform</em> and <em>summarize</em> our data.</li>
</ul>
</div>
<div class="fragment" data-fragment-index="2">
<ul>
<li>We’ll use the pipe operator, <span class="fg-pink"><strong><code>|&gt;</code></strong></span>, to chain together sequences of actions on our tables.</li>
</ul>
</div>
</section></section>
<section>
<section id="dplyrs-core-verbs" class="title-slide slide level1 inv-title center" data-background-color="#252F3E">
<h1>dplyr’s core verbs</h1>

</section>
<section class="slide level2">

<div class="huge">
<p><code>dplyr</code> draws on the logic and language of <span class="fg-green">database queries</span></p>
</div>
</section>
<section id="some-actions-to-take-on-a-single-table" class="slide level2">
<h2>Some <span class="fg-orange">actions</span> to take on a single table</h2>
<div>
<ul>
<li class="fragment"><p><span class="fg-orange"><strong>Group</strong></span> the data at the level we want, such as “<em>Religion by Region</em>” or “<em>Children by School</em>”.</p></li>
<li class="fragment"><p><span class="fg-orange"><strong>Subset</strong></span> either the rows or columns of or table—i.e.&nbsp;remove them before doing anything.</p></li>
<li class="fragment"><p><span class="fg-orange"><strong>Mutate</strong></span> the data. That is, change something at the <em>current</em> level of grouping. Mutating adds new columns to the table, or changes the content of an existing column. It never changes the number of rows.</p></li>
<li class="fragment"><p><span class="fg-orange"><strong>Summarize</strong></span> or aggregate the data. That is, make something new at a <em>higher</em> level of grouping. E.g., calculate means or counts by some grouping variable. This will generally result in a smaller, <em>summary</em> table. Usually this will have the same number of <em>rows</em> as there are <em>groups</em> being summarized.</p></li>
</ul>
</div>
</section>
<section id="for-each-action-theres-a-function" class="slide level2">
<h2>For each <span class="fg-orange">action</span> there’s a <span class="fg-green">function</span></h2>
<div>
<ul>
<li class="fragment"><span class="fg-orange"><strong>Group</strong></span> using <strong><code>group_by()</code></strong>.</li>
<li class="fragment"><span class="fg-orange"><strong>Subset</strong></span> has one action for rows and one for columns. We <strong><code>filter()</code></strong> rows and <strong><code>select()</code></strong> columns.</li>
<li class="fragment"><span class="fg-orange"><strong>Mutate</strong></span> tables (i.e.&nbsp;add new columns, or re-make existing ones) using <strong><code>mutate()</code></strong>.</li>
<li class="fragment"><span class="fg-orange"><strong>Summarize</strong></span> tables (i.e.&nbsp;perform aggregating calculations) using <strong><code>summarize()</code></strong>.</li>
</ul>
</div>
</section></section>
<section>
<section id="group-and-summarize" class="title-slide slide level1 inv-title center" data-background-color="#252F3E">
<h1>Group and Summarize</h1>

</section>
<section id="general-social-survey-data-gss_sm" class="slide level2">
<h2>General Social Survey data: <span class="fg-pink"><code>gss_sm</code></span></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a aria-hidden="true" tabindex="-1"></a><span class="do">## library(socviz) # if not loaded</span></span>
<span id="cb2-2"><a aria-hidden="true" tabindex="-1"></a>gss_sm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2,867 × 32
    year    id ballot       age childs sibs   degree race  sex   region income16
   &lt;dbl&gt; &lt;dbl&gt; &lt;labelled&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;labe&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   
 1  2016     1 1             47      3 2      Bache… White Male  New E… $170000…
 2  2016     2 2             61      0 3      High … White Male  New E… $50000 …
 3  2016     3 3             72      2 3      Bache… White Male  New E… $75000 …
 4  2016     4 1             43      4 3      High … White Fema… New E… $170000…
 5  2016     5 3             55      2 2      Gradu… White Fema… New E… $170000…
 6  2016     6 2             53      2 2      Junio… White Fema… New E… $60000 …
 7  2016     7 1             50      2 2      High … White Male  New E… $170000…
 8  2016     8 3             23      3 6      High … Other Fema… Middl… $30000 …
 9  2016     9 1             45      3 5      High … Black Male  Middl… $60000 …
10  2016    10 3             71      4 1      Junio… White Male  Middl… $60000 …
# ℹ 2,857 more rows
# ℹ 21 more variables: relig &lt;fct&gt;, marital &lt;fct&gt;, padeg &lt;fct&gt;, madeg &lt;fct&gt;,
#   partyid &lt;fct&gt;, polviews &lt;fct&gt;, happy &lt;fct&gt;, partners &lt;fct&gt;, grass &lt;fct&gt;,
#   zodiac &lt;fct&gt;, pres12 &lt;labelled&gt;, wtssall &lt;dbl&gt;, income_rc &lt;fct&gt;,
#   agegrp &lt;fct&gt;, ageq &lt;fct&gt;, siblings &lt;fct&gt;, kids &lt;fct&gt;, religion &lt;fct&gt;,
#   bigregion &lt;fct&gt;, partners_rc &lt;fct&gt;, obama &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="fragment" data-fragment-index="1">
<p>Notice how the tibble already tells us a lot.</p>
</div>
</section>
<section id="summarizing-a-table" class="slide level2">
<h2>Summarizing a Table</h2>
<ul>
<li>Here’s what we’re going to do:</li>
</ul>
<p><img data-src="img/dplyr-pipe-example.png">]</p>
</section>
<section id="summarizing-a-table-1" class="slide level2">
<h2>Summarizing a Table</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, bigregion, religion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2,867 × 3
      id bigregion religion  
   &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;     
 1     1 Northeast None      
 2     2 Northeast None      
 3     3 Northeast Catholic  
 4     4 Northeast Catholic  
 5     5 Northeast None      
 6     6 Northeast None      
 7     7 Northeast None      
 8     8 Northeast Catholic  
 9     9 Northeast Protestant
10    10 Northeast None      
# ℹ 2,857 more rows</code></pre>
</div>
</div>
<p>We’re just taking a look at the relevant columns here.</p>
</section>
<section id="group-by-one-column-or-variable" class="slide level2">
<h2>Group by <span class="fg-orange"><em>one</em></span> column or variable</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2,867 × 32
# Groups:   bigregion [4]
    year    id ballot       age childs sibs   degree race  sex   region income16
   &lt;dbl&gt; &lt;dbl&gt; &lt;labelled&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;labe&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   
 1  2016     1 1             47      3 2      Bache… White Male  New E… $170000…
 2  2016     2 2             61      0 3      High … White Male  New E… $50000 …
 3  2016     3 3             72      2 3      Bache… White Male  New E… $75000 …
 4  2016     4 1             43      4 3      High … White Fema… New E… $170000…
 5  2016     5 3             55      2 2      Gradu… White Fema… New E… $170000…
 6  2016     6 2             53      2 2      Junio… White Fema… New E… $60000 …
 7  2016     7 1             50      2 2      High … White Male  New E… $170000…
 8  2016     8 3             23      3 6      High … Other Fema… Middl… $30000 …
 9  2016     9 1             45      3 5      High … Black Male  Middl… $60000 …
10  2016    10 3             71      4 1      Junio… White Male  Middl… $60000 …
# ℹ 2,857 more rows
# ℹ 21 more variables: relig &lt;fct&gt;, marital &lt;fct&gt;, padeg &lt;fct&gt;, madeg &lt;fct&gt;,
#   partyid &lt;fct&gt;, polviews &lt;fct&gt;, happy &lt;fct&gt;, partners &lt;fct&gt;, grass &lt;fct&gt;,
#   zodiac &lt;fct&gt;, pres12 &lt;labelled&gt;, wtssall &lt;dbl&gt;, income_rc &lt;fct&gt;,
#   agegrp &lt;fct&gt;, ageq &lt;fct&gt;, siblings &lt;fct&gt;, kids &lt;fct&gt;, religion &lt;fct&gt;,
#   bigregion &lt;fct&gt;, partners_rc &lt;fct&gt;, obama &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Grouping just changes the logical structure of the tibble.</p>
</section>
<section id="group-and-summarize-by-one-column" class="slide level2">
<h2>Group and summarize by <em>one</em> column</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2,867 × 32
    year    id ballot       age childs sibs   degree race  sex   region income16
   &lt;dbl&gt; &lt;dbl&gt; &lt;labelled&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;labe&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   
 1  2016     1 1             47      3 2      Bache… White Male  New E… $170000…
 2  2016     2 2             61      0 3      High … White Male  New E… $50000 …
 3  2016     3 3             72      2 3      Bache… White Male  New E… $75000 …
 4  2016     4 1             43      4 3      High … White Fema… New E… $170000…
 5  2016     5 3             55      2 2      Gradu… White Fema… New E… $170000…
 6  2016     6 2             53      2 2      Junio… White Fema… New E… $60000 …
 7  2016     7 1             50      2 2      High … White Male  New E… $170000…
 8  2016     8 3             23      3 6      High … Other Fema… Middl… $30000 …
 9  2016     9 1             45      3 5      High … Black Male  Middl… $60000 …
10  2016    10 3             71      4 1      Junio… White Male  Middl… $60000 …
# ℹ 2,857 more rows
# ℹ 21 more variables: relig &lt;fct&gt;, marital &lt;fct&gt;, padeg &lt;fct&gt;, madeg &lt;fct&gt;,
#   partyid &lt;fct&gt;, polviews &lt;fct&gt;, happy &lt;fct&gt;, partners &lt;fct&gt;, grass &lt;fct&gt;,
#   zodiac &lt;fct&gt;, pres12 &lt;labelled&gt;, wtssall &lt;dbl&gt;, income_rc &lt;fct&gt;,
#   agegrp &lt;fct&gt;, ageq &lt;fct&gt;, siblings &lt;fct&gt;, kids &lt;fct&gt;, religion &lt;fct&gt;,
#   bigregion &lt;fct&gt;, partners_rc &lt;fct&gt;, obama &lt;dbl&gt;</code></pre>
</div>
</div>
</div></div>
</section>
<section id="group-and-summarize-by-one-column-1" class="slide level2">
<h2>Group and summarize by <em>one</em> column</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2,867 × 32
# Groups:   bigregion [4]
    year    id ballot       age childs sibs   degree race  sex   region income16
   &lt;dbl&gt; &lt;dbl&gt; &lt;labelled&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;labe&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   
 1  2016     1 1             47      3 2      Bache… White Male  New E… $170000…
 2  2016     2 2             61      0 3      High … White Male  New E… $50000 …
 3  2016     3 3             72      2 3      Bache… White Male  New E… $75000 …
 4  2016     4 1             43      4 3      High … White Fema… New E… $170000…
 5  2016     5 3             55      2 2      Gradu… White Fema… New E… $170000…
 6  2016     6 2             53      2 2      Junio… White Fema… New E… $60000 …
 7  2016     7 1             50      2 2      High … White Male  New E… $170000…
 8  2016     8 3             23      3 6      High … Other Fema… Middl… $30000 …
 9  2016     9 1             45      3 5      High … Black Male  Middl… $60000 …
10  2016    10 3             71      4 1      Junio… White Male  Middl… $60000 …
# ℹ 2,857 more rows
# ℹ 21 more variables: relig &lt;fct&gt;, marital &lt;fct&gt;, padeg &lt;fct&gt;, madeg &lt;fct&gt;,
#   partyid &lt;fct&gt;, polviews &lt;fct&gt;, happy &lt;fct&gt;, partners &lt;fct&gt;, grass &lt;fct&gt;,
#   zodiac &lt;fct&gt;, pres12 &lt;labelled&gt;, wtssall &lt;dbl&gt;, income_rc &lt;fct&gt;,
#   agegrp &lt;fct&gt;, ageq &lt;fct&gt;, siblings &lt;fct&gt;, kids &lt;fct&gt;, religion &lt;fct&gt;,
#   bigregion &lt;fct&gt;, partners_rc &lt;fct&gt;, obama &lt;dbl&gt;</code></pre>
</div>
</div>
</div></div>
</section>
<section id="group-and-summarize-by-one-column-2" class="slide level2">
<h2>Group and summarize by <em>one</em> column</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 4 × 2
  bigregion total
  &lt;fct&gt;     &lt;int&gt;
1 Northeast   488
2 Midwest     695
3 South      1052
4 West        632</code></pre>
</div>
</div>
</div></div>
<div>
<ul>
<li class="fragment">The function <span class="fg-green"><strong><code>n()</code></strong></span> counts up the rows within each group.<br>
</li>
<li class="fragment">All the other columns are dropped in the summary operation</li>
<li class="fragment">Your original <span class="fg-pink"><code>gss_sm</code></span> table is untouched</li>
</ul>
</div>
</section>
<section id="group-and-summarize-by-two-columns" class="slide level2">
<h2>Group and summarize by <em>two</em> columns</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2,867 × 32
    year    id ballot       age childs sibs   degree race  sex   region income16
   &lt;dbl&gt; &lt;dbl&gt; &lt;labelled&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;labe&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   
 1  2016     1 1             47      3 2      Bache… White Male  New E… $170000…
 2  2016     2 2             61      0 3      High … White Male  New E… $50000 …
 3  2016     3 3             72      2 3      Bache… White Male  New E… $75000 …
 4  2016     4 1             43      4 3      High … White Fema… New E… $170000…
 5  2016     5 3             55      2 2      Gradu… White Fema… New E… $170000…
 6  2016     6 2             53      2 2      Junio… White Fema… New E… $60000 …
 7  2016     7 1             50      2 2      High … White Male  New E… $170000…
 8  2016     8 3             23      3 6      High … Other Fema… Middl… $30000 …
 9  2016     9 1             45      3 5      High … Black Male  Middl… $60000 …
10  2016    10 3             71      4 1      Junio… White Male  Middl… $60000 …
# ℹ 2,857 more rows
# ℹ 21 more variables: relig &lt;fct&gt;, marital &lt;fct&gt;, padeg &lt;fct&gt;, madeg &lt;fct&gt;,
#   partyid &lt;fct&gt;, polviews &lt;fct&gt;, happy &lt;fct&gt;, partners &lt;fct&gt;, grass &lt;fct&gt;,
#   zodiac &lt;fct&gt;, pres12 &lt;labelled&gt;, wtssall &lt;dbl&gt;, income_rc &lt;fct&gt;,
#   agegrp &lt;fct&gt;, ageq &lt;fct&gt;, siblings &lt;fct&gt;, kids &lt;fct&gt;, religion &lt;fct&gt;,
#   bigregion &lt;fct&gt;, partners_rc &lt;fct&gt;, obama &lt;dbl&gt;</code></pre>
</div>
</div>
</div></div>
</section>
<section id="group-and-summarize-by-two-columns-1" class="slide level2">
<h2>Group and summarize by <em>two</em> columns</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2,867 × 32
# Groups:   bigregion, religion [24]
    year    id ballot       age childs sibs   degree race  sex   region income16
   &lt;dbl&gt; &lt;dbl&gt; &lt;labelled&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;labe&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   
 1  2016     1 1             47      3 2      Bache… White Male  New E… $170000…
 2  2016     2 2             61      0 3      High … White Male  New E… $50000 …
 3  2016     3 3             72      2 3      Bache… White Male  New E… $75000 …
 4  2016     4 1             43      4 3      High … White Fema… New E… $170000…
 5  2016     5 3             55      2 2      Gradu… White Fema… New E… $170000…
 6  2016     6 2             53      2 2      Junio… White Fema… New E… $60000 …
 7  2016     7 1             50      2 2      High … White Male  New E… $170000…
 8  2016     8 3             23      3 6      High … Other Fema… Middl… $30000 …
 9  2016     9 1             45      3 5      High … Black Male  Middl… $60000 …
10  2016    10 3             71      4 1      Junio… White Male  Middl… $60000 …
# ℹ 2,857 more rows
# ℹ 21 more variables: relig &lt;fct&gt;, marital &lt;fct&gt;, padeg &lt;fct&gt;, madeg &lt;fct&gt;,
#   partyid &lt;fct&gt;, polviews &lt;fct&gt;, happy &lt;fct&gt;, partners &lt;fct&gt;, grass &lt;fct&gt;,
#   zodiac &lt;fct&gt;, pres12 &lt;labelled&gt;, wtssall &lt;dbl&gt;, income_rc &lt;fct&gt;,
#   agegrp &lt;fct&gt;, ageq &lt;fct&gt;, siblings &lt;fct&gt;, kids &lt;fct&gt;, religion &lt;fct&gt;,
#   bigregion &lt;fct&gt;, partners_rc &lt;fct&gt;, obama &lt;dbl&gt;</code></pre>
</div>
</div>
</div></div>
</section>
<section id="group-and-summarize-by-two-columns-2" class="slide level2">
<h2>Group and summarize by <em>two</em> columns</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 3
# Groups:   bigregion [4]
   bigregion religion   total
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1 Northeast Protestant   158
 2 Northeast Catholic     162
 3 Northeast Jewish        27
 4 Northeast None         112
 5 Northeast Other         28
 6 Northeast &lt;NA&gt;           1
 7 Midwest   Protestant   325
 8 Midwest   Catholic     172
 9 Midwest   Jewish         3
10 Midwest   None         157
# ℹ 14 more rows</code></pre>
</div>
</div>
</div></div>
<div>
<ul>
<li class="fragment">The function <span class="fg-green"><strong><code>n()</code></strong></span> counts up the rows within the <em>innermost</em> (i.e.&nbsp;the rightmost) group.</li>
</ul>
</div>
</section>
<section id="calculate-frequencies" class="slide level2">
<h2>Calculate frequencies</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2,867 × 32
    year    id ballot       age childs sibs   degree race  sex   region income16
   &lt;dbl&gt; &lt;dbl&gt; &lt;labelled&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;labe&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   
 1  2016     1 1             47      3 2      Bache… White Male  New E… $170000…
 2  2016     2 2             61      0 3      High … White Male  New E… $50000 …
 3  2016     3 3             72      2 3      Bache… White Male  New E… $75000 …
 4  2016     4 1             43      4 3      High … White Fema… New E… $170000…
 5  2016     5 3             55      2 2      Gradu… White Fema… New E… $170000…
 6  2016     6 2             53      2 2      Junio… White Fema… New E… $60000 …
 7  2016     7 1             50      2 2      High … White Male  New E… $170000…
 8  2016     8 3             23      3 6      High … Other Fema… Middl… $30000 …
 9  2016     9 1             45      3 5      High … Black Male  Middl… $60000 …
10  2016    10 3             71      4 1      Junio… White Male  Middl… $60000 …
# ℹ 2,857 more rows
# ℹ 21 more variables: relig &lt;fct&gt;, marital &lt;fct&gt;, padeg &lt;fct&gt;, madeg &lt;fct&gt;,
#   partyid &lt;fct&gt;, polviews &lt;fct&gt;, happy &lt;fct&gt;, partners &lt;fct&gt;, grass &lt;fct&gt;,
#   zodiac &lt;fct&gt;, pres12 &lt;labelled&gt;, wtssall &lt;dbl&gt;, income_rc &lt;fct&gt;,
#   agegrp &lt;fct&gt;, ageq &lt;fct&gt;, siblings &lt;fct&gt;, kids &lt;fct&gt;, religion &lt;fct&gt;,
#   bigregion &lt;fct&gt;, partners_rc &lt;fct&gt;, obama &lt;dbl&gt;</code></pre>
</div>
</div>
</div></div>
</section>
<section id="calculate-frequencies-1" class="slide level2">
<h2>Calculate frequencies</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2,867 × 32
# Groups:   bigregion, religion [24]
    year    id ballot       age childs sibs   degree race  sex   region income16
   &lt;dbl&gt; &lt;dbl&gt; &lt;labelled&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;labe&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   
 1  2016     1 1             47      3 2      Bache… White Male  New E… $170000…
 2  2016     2 2             61      0 3      High … White Male  New E… $50000 …
 3  2016     3 3             72      2 3      Bache… White Male  New E… $75000 …
 4  2016     4 1             43      4 3      High … White Fema… New E… $170000…
 5  2016     5 3             55      2 2      Gradu… White Fema… New E… $170000…
 6  2016     6 2             53      2 2      Junio… White Fema… New E… $60000 …
 7  2016     7 1             50      2 2      High … White Male  New E… $170000…
 8  2016     8 3             23      3 6      High … Other Fema… Middl… $30000 …
 9  2016     9 1             45      3 5      High … Black Male  Middl… $60000 …
10  2016    10 3             71      4 1      Junio… White Male  Middl… $60000 …
# ℹ 2,857 more rows
# ℹ 21 more variables: relig &lt;fct&gt;, marital &lt;fct&gt;, padeg &lt;fct&gt;, madeg &lt;fct&gt;,
#   partyid &lt;fct&gt;, polviews &lt;fct&gt;, happy &lt;fct&gt;, partners &lt;fct&gt;, grass &lt;fct&gt;,
#   zodiac &lt;fct&gt;, pres12 &lt;labelled&gt;, wtssall &lt;dbl&gt;, income_rc &lt;fct&gt;,
#   agegrp &lt;fct&gt;, ageq &lt;fct&gt;, siblings &lt;fct&gt;, kids &lt;fct&gt;, religion &lt;fct&gt;,
#   bigregion &lt;fct&gt;, partners_rc &lt;fct&gt;, obama &lt;dbl&gt;</code></pre>
</div>
</div>
</div></div>
</section>
<section id="calculate-frequencies-2" class="slide level2">
<h2>Calculate frequencies</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 3
# Groups:   bigregion [4]
   bigregion religion   total
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1 Northeast Protestant   158
 2 Northeast Catholic     162
 3 Northeast Jewish        27
 4 Northeast None         112
 5 Northeast Other         28
 6 Northeast &lt;NA&gt;           1
 7 Midwest   Protestant   325
 8 Midwest   Catholic     172
 9 Midwest   Jewish         3
10 Midwest   None         157
# ℹ 14 more rows</code></pre>
</div>
</div>
</div></div>
</section>
<section id="calculate-frequencies-3" class="slide level2">
<h2>Calculate frequencies</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq =</span> total <span class="sc">/</span> <span class="fu">sum</span>(total),</span>
<span id="cb26-5"><a aria-hidden="true" tabindex="-1"></a>           <span class="at">pct =</span> <span class="fu">round</span>((freq<span class="sc">*</span><span class="dv">100</span>), <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 5
# Groups:   bigregion [4]
   bigregion religion   total    freq   pct
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 Northeast Protestant   158 0.324    32.4
 2 Northeast Catholic     162 0.332    33.2
 3 Northeast Jewish        27 0.0553    5.5
 4 Northeast None         112 0.230    23  
 5 Northeast Other         28 0.0574    5.7
 6 Northeast &lt;NA&gt;           1 0.00205   0.2
 7 Midwest   Protestant   325 0.468    46.8
 8 Midwest   Catholic     172 0.247    24.7
 9 Midwest   Jewish         3 0.00432   0.4
10 Midwest   None         157 0.226    22.6
# ℹ 14 more rows</code></pre>
</div>
</div>
</div></div>
<div>
<ul>
<li class="fragment">The function <span class="fg-green"><strong><code>n()</code></strong></span> counts up the rows</li>
<li class="fragment">Which rows? The ones fed down the pipeline</li>
<li class="fragment">The <em>innermost</em> (i.e.&nbsp;the rightmost) group.</li>
</ul>
</div>
</section>
<section id="pipelines-carry-assumptions-forward" class="slide level2">
<h2>Pipelines carry assumptions forward</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28" data-source-line-numbers="nil" data-code-line-numbers="2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb28-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq =</span> total <span class="sc">/</span> <span class="fu">sum</span>(total),</span>
<span id="cb28-5"><a aria-hidden="true" tabindex="-1"></a>           <span class="at">pct =</span> <span class="fu">round</span>((freq<span class="sc">*</span><span class="dv">100</span>), <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 5
# Groups:   bigregion [4]
   bigregion religion   total    freq   pct
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 Northeast Protestant   158 0.324    32.4
 2 Northeast Catholic     162 0.332    33.2
 3 Northeast Jewish        27 0.0553    5.5
 4 Northeast None         112 0.230    23  
 5 Northeast Other         28 0.0574    5.7
 6 Northeast &lt;NA&gt;           1 0.00205   0.2
 7 Midwest   Protestant   325 0.468    46.8
 8 Midwest   Catholic     172 0.247    24.7
 9 Midwest   Jewish         3 0.00432   0.4
10 Midwest   None         157 0.226    22.6
# ℹ 14 more rows</code></pre>
</div>
</div>
<div class="tiny">
<ul>
<li>Groups are carried forward till summarized or explicitly ungrouped</li>
<li>Summary calculations are done on the innermost group, which then “disappears”.</li>
</ul>
</div>
</section>
<section id="pipelines-carry-assumptions-forward-1" class="slide level2">
<h2>Pipelines carry assumptions forward</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30" data-source-line-numbers="nil" data-code-line-numbers="5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb30-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq =</span> total <span class="sc">/</span> <span class="fu">sum</span>(total),</span>
<span id="cb30-5"><a aria-hidden="true" tabindex="-1"></a>           <span class="at">pct =</span> <span class="fu">round</span>((freq<span class="sc">*</span><span class="dv">100</span>), <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 5
# Groups:   bigregion [4]
   bigregion religion   total    freq   pct
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 Northeast Protestant   158 0.324    32.4
 2 Northeast Catholic     162 0.332    33.2
 3 Northeast Jewish        27 0.0553    5.5
 4 Northeast None         112 0.230    23  
 5 Northeast Other         28 0.0574    5.7
 6 Northeast &lt;NA&gt;           1 0.00205   0.2
 7 Midwest   Protestant   325 0.468    46.8
 8 Midwest   Catholic     172 0.247    24.7
 9 Midwest   Jewish         3 0.00432   0.4
10 Midwest   None         157 0.226    22.6
# ℹ 14 more rows</code></pre>
</div>
</div>
<p><span class="fg-green"><strong><code>mutate()</code></strong></span> is quite clever. See how we can immediately use <strong><code>freq</code></strong>, even though we are creating it in the same <span class="fg-green"><strong><code>mutate()</code></strong></span> expression.</p>
</section>
<section id="convenience-functions" class="slide level2">
<h2>Convenience functions</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32" data-source-line-numbers="nil" data-code-line-numbers="2,3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb32-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq =</span> total <span class="sc">/</span> <span class="fu">sum</span>(total),</span>
<span id="cb32-5"><a aria-hidden="true" tabindex="-1"></a>           <span class="at">pct =</span> <span class="fu">round</span>((freq<span class="sc">*</span><span class="dv">100</span>), <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 5
# Groups:   bigregion [4]
   bigregion religion   total    freq   pct
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 Northeast Protestant   158 0.324    32.4
 2 Northeast Catholic     162 0.332    33.2
 3 Northeast Jewish        27 0.0553    5.5
 4 Northeast None         112 0.230    23  
 5 Northeast Other         28 0.0574    5.7
 6 Northeast &lt;NA&gt;           1 0.00205   0.2
 7 Midwest   Protestant   325 0.468    46.8
 8 Midwest   Catholic     172 0.247    24.7
 9 Midwest   Jewish         3 0.00432   0.4
10 Midwest   None         157 0.226    22.6
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>We’re going to be doing this <span class="fg-green"><strong><code>group_by()</code></strong></span> … <span class="fg-green"><strong><code>n()</code></strong></span> step a lot. Some shorthand for it would be useful.</p>
</section>
<section id="three-options-for-counting-up-rows" class="slide level2">
<h2>Three options for counting up rows</h2>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li>Use <span class="fg-green"><strong><code>n()</code></strong></span></li>
</ul>
<div class="smallcode">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34" data-source-line-numbers="nil" data-code-line-numbers="2,3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 3
# Groups:   bigregion [4]
   bigregion religion       n
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1 Northeast Protestant   158
 2 Northeast Catholic     162
 3 Northeast Jewish        27
 4 Northeast None         112
 5 Northeast Other         28
 6 Northeast &lt;NA&gt;           1
 7 Midwest   Protestant   325
 8 Midwest   Catholic     172
 9 Midwest   Jewish         3
10 Midwest   None         157
# ℹ 14 more rows</code></pre>
</div>
</div>
</div>
<ul>
<li>Group it yourself; result is grouped.</li>
</ul>
</div><div class="column" style="width:30%;">
<ul>
<li>Use <span class="fg-green"><strong><code>tally()</code></strong></span></li>
</ul>
<div class="smallcode">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36" data-source-line-numbers="nil" data-code-line-numbers="3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 3
# Groups:   bigregion [4]
   bigregion religion       n
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1 Northeast Protestant   158
 2 Northeast Catholic     162
 3 Northeast Jewish        27
 4 Northeast None         112
 5 Northeast Other         28
 6 Northeast &lt;NA&gt;           1
 7 Midwest   Protestant   325
 8 Midwest   Catholic     172
 9 Midwest   Jewish         3
10 Midwest   None         157
# ℹ 14 more rows</code></pre>
</div>
</div>
</div>
<ul>
<li>More compact; result is grouped.</li>
</ul>
</div><div class="column right" style="width:30%;">
<ul>
<li>Use <span class="fg-green"><strong><code>count()</code></strong></span></li>
</ul>
<div class="smallcode">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38" data-source-line-numbers="nil" data-code-line-numbers="2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigregion, religion) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 3
   bigregion religion       n
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1 Northeast Protestant   158
 2 Northeast Catholic     162
 3 Northeast Jewish        27
 4 Northeast None         112
 5 Northeast Other         28
 6 Northeast &lt;NA&gt;           1
 7 Midwest   Protestant   325
 8 Midwest   Catholic     172
 9 Midwest   Jewish         3
10 Midwest   None         157
# ℹ 14 more rows</code></pre>
</div>
</div>
</div>
<ul>
<li>One step; result is not grouped.</li>
</ul>
</div></div>
</section>
<section id="pass-results-on-to-a-table" class="slide level2">
<h2>Pass results on to … a <span class="fg-yellow">table</span></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40" data-source-line-numbers="nil" data-code-line-numbers="3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> bigregion, <span class="at">values_from =</span> n) <span class="sc">|&gt;</span>  </span>
<span id="cb40-4"><a aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">religion</th>
<th style="text-align: right;">Northeast</th>
<th style="text-align: right;">Midwest</th>
<th style="text-align: right;">South</th>
<th style="text-align: right;">West</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Protestant</td>
<td style="text-align: right;">158</td>
<td style="text-align: right;">325</td>
<td style="text-align: right;">650</td>
<td style="text-align: right;">238</td>
</tr>
<tr class="even">
<td style="text-align: left;">Catholic</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">155</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jewish</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">None</td>
<td style="text-align: right;">112</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">180</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>More on <span class="fg-green"><strong><code>pivot_wider()</code></strong></span> and <span class="fg-green"><strong><code>kable()</code></strong></span> soon …</li>
</ul>
</section>
<section id="pass-results-on-to-a-graph" class="slide level2">
<h2>Pass results on to … a <span class="fg-yellow">graph</span></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41" data-source-line-numbers="nil" data-code-line-numbers="6,7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">|&gt;</span> </span>
<span id="cb41-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>((n<span class="sc">/</span><span class="fu">sum</span>(n))<span class="sc">*</span><span class="dv">100</span>), <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb41-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pct, <span class="at">y =</span> <span class="fu">reorder</span>(religion, <span class="sc">-</span>pct), <span class="at">fill =</span> religion)) <span class="sc">+</span> </span>
<span id="cb41-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb41-8"><a aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Percent"</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb41-9"><a aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb41-10"><a aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> bigregion, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="03a-dplyr-basics_files/figure-revealjs/03a-dplyr-basics-17-1.png" class="quarto-figure quarto-figure-center r-stretch" width="1440"></section>
<section id="pass-results-on-to-an-object" class="slide level2">
<h2>Pass results on to … an <span class="fg-yellow">object</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>You can do it like this …</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42" data-source-line-numbers="nil" data-code-line-numbers="1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a aria-hidden="true" tabindex="-1"></a>rel_by_region <span class="ot">&lt;-</span> gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>((n<span class="sc">/</span><span class="fu">sum</span>(n))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)) </span>
<span id="cb42-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a aria-hidden="true" tabindex="-1"></a>rel_by_region</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 4
   bigregion religion       n   pct
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Northeast Protestant   158   5.5
 2 Northeast Catholic     162   5.7
 3 Northeast Jewish        27   0.9
 4 Northeast None         112   3.9
 5 Northeast Other         28   1  
 6 Northeast &lt;NA&gt;           1   0  
 7 Midwest   Protestant   325  11.3
 8 Midwest   Catholic     172   6  
 9 Midwest   Jewish         3   0.1
10 Midwest   None         157   5.5
# ℹ 14 more rows</code></pre>
</div>
</div>
</div><div class="column right" style="width:50%;">

</div></div>
</section>
<section id="pass-results-on-to-an-object-1" class="slide level2">
<h2>Pass results on to … an <span class="fg-yellow">object</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>You can do it like this …</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44" data-source-line-numbers="nil" data-code-line-numbers="1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a aria-hidden="true" tabindex="-1"></a>rel_by_region <span class="ot">&lt;-</span> gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>((n<span class="sc">/</span><span class="fu">sum</span>(n))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)) </span>
<span id="cb44-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a aria-hidden="true" tabindex="-1"></a>rel_by_region</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 4
   bigregion religion       n   pct
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Northeast Protestant   158   5.5
 2 Northeast Catholic     162   5.7
 3 Northeast Jewish        27   0.9
 4 Northeast None         112   3.9
 5 Northeast Other         28   1  
 6 Northeast &lt;NA&gt;           1   0  
 7 Midwest   Protestant   325  11.3
 8 Midwest   Catholic     172   6  
 9 Midwest   Jewish         3   0.1
10 Midwest   None         157   5.5
# ℹ 14 more rows</code></pre>
</div>
</div>
</div><div class="column right" style="width:50%;">
<ul>
<li>Or like this!</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46" data-source-line-numbers="nil" data-code-line-numbers="3,4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>((n<span class="sc">/</span><span class="fu">sum</span>(n))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)) <span class="ot">-&gt;</span> </span>
<span id="cb46-4"><a aria-hidden="true" tabindex="-1"></a>rel_by_region </span>
<span id="cb46-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a aria-hidden="true" tabindex="-1"></a>rel_by_region</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 4
   bigregion religion       n   pct
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Northeast Protestant   158   5.5
 2 Northeast Catholic     162   5.7
 3 Northeast Jewish        27   0.9
 4 Northeast None         112   3.9
 5 Northeast Other         28   1  
 6 Northeast &lt;NA&gt;           1   0  
 7 Midwest   Protestant   325  11.3
 8 Midwest   Catholic     172   6  
 9 Midwest   Jewish         3   0.1
10 Midwest   None         157   5.5
# ℹ 14 more rows</code></pre>
</div>
</div>
</div></div>
</section>
<section id="right-assignmment-is-a-thing-like-left" class="slide level2">
<h2><span class="fg-lblue">Right</span> assignmment is a thing, like <span class="fg-red">Left</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><span class="fg-red">Left</span> assignment is standard</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a aria-hidden="true" tabindex="-1"></a>gss_tab <span class="ot">&lt;-</span> gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigregion, religion) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>This may feel awkward with a pipe: “<code>gss_tab</code> <span class="fg-orange"><em>gets</em></span> the output of the following pipeline.”</li>
</ul>
</div><div class="column right" style="width:50%;">
<ul>
<li><span class="fg-lblue">Right</span> assignment also works!</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigregion, religion) <span class="ot">-&gt;</span> gss_tab  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Without any authority, I assert that right-assignment should be read as, e.g., “This pipeline <span class="fg-orange"><em>begets</em></span> <code>gss_tab</code>”</li>
</ul>
</div></div>
</section>
<section id="check-by-summarizing" class="slide level2">
<h2>Check by summarizing</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a aria-hidden="true" tabindex="-1"></a>rel_by_region <span class="ot">&lt;-</span> gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>((n<span class="sc">/</span><span class="fu">sum</span>(n))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)) </span>
<span id="cb50-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a aria-hidden="true" tabindex="-1"></a>rel_by_region</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 4
   bigregion religion       n   pct
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Northeast Protestant   158   5.5
 2 Northeast Catholic     162   5.7
 3 Northeast Jewish        27   0.9
 4 Northeast None         112   3.9
 5 Northeast Other         28   1  
 6 Northeast &lt;NA&gt;           1   0  
 7 Midwest   Protestant   325  11.3
 8 Midwest   Catholic     172   6  
 9 Midwest   Jewish         3   0.1
10 Midwest   None         157   5.5
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>Hm, did I sum over right group?</p>
</div><div class="column right" style="width:50%;">

</div></div>
</section>
<section id="check-by-summarizing-1" class="slide level2">
<h2>Check by summarizing</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a aria-hidden="true" tabindex="-1"></a>rel_by_region <span class="ot">&lt;-</span> gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb52-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>((n<span class="sc">/</span><span class="fu">sum</span>(n))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)) </span>
<span id="cb52-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a aria-hidden="true" tabindex="-1"></a>rel_by_region</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 24 × 4
   bigregion religion       n   pct
   &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Northeast Protestant   158   5.5
 2 Northeast Catholic     162   5.7
 3 Northeast Jewish        27   0.9
 4 Northeast None         112   3.9
 5 Northeast Other         28   1  
 6 Northeast &lt;NA&gt;           1   0  
 7 Midwest   Protestant   325  11.3
 8 Midwest   Catholic     172   6  
 9 Midwest   Jewish         3   0.1
10 Midwest   None         157   5.5
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>Hm, did I sum over right group?</p>
</div><div class="column right" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a aria-hidden="true" tabindex="-1"></a><span class="do">## Each region should sum to ~100</span></span>
<span id="cb54-2"><a aria-hidden="true" tabindex="-1"></a>rel_by_region <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion) <span class="sc">|&gt;</span> </span>
<span id="cb54-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">sum</span>(pct)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 4 × 2
  bigregion total
  &lt;fct&gt;     &lt;dbl&gt;
1 Northeast  17  
2 Midwest    24.3
3 South      36.7
4 West       22  </code></pre>
</div>
</div>
<p>No! What has gone wrong here?</p>
</div></div>
</section>
<section id="check-by-summarizing-2" class="slide level2">
<h2>Check by summarizing</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56" data-source-line-numbers="nil" data-code-line-numbers="2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a aria-hidden="true" tabindex="-1"></a>rel_by_region <span class="ot">&lt;-</span> gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb56-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>((n<span class="sc">/</span><span class="fu">sum</span>(n))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tiny">
<p><span class="fg-green"><strong><code>count()</code></strong></span> returns ungrouped results, so there are no groups carry forward to the <span class="fg-green"><strong><code>mutate()</code></strong></span> step.</p>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a aria-hidden="true" tabindex="-1"></a>rel_by_region <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">sum</span>(pct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 1 × 1
  total
  &lt;dbl&gt;
1   100</code></pre>
</div>
</div>
<div class="tiny">
<p>With <span class="fg-green"><strong><code>count()</code></strong></span>, the <code>pct</code> values here are the marginals for the whole table.</p>
</div>
</div><div class="column right" style="width:50%;">

</div></div>
</section>
<section id="check-by-summarizing-3" class="slide level2">
<h2>Check by summarizing</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59" data-source-line-numbers="nil" data-code-line-numbers="2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a aria-hidden="true" tabindex="-1"></a>rel_by_region <span class="ot">&lt;-</span> gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>((n<span class="sc">/</span><span class="fu">sum</span>(n))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tiny">
<p><span class="fg-green"><strong><code>count()</code></strong></span> returns ungrouped results, so there are no groups carry forward to the <span class="fg-green"><strong><code>mutate()</code></strong></span> step.</p>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a aria-hidden="true" tabindex="-1"></a>rel_by_region <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">sum</span>(pct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 1 × 1
  total
  &lt;dbl&gt;
1   100</code></pre>
</div>
</div>
<div class="tiny">
<p>With <span class="fg-green"><strong><code>count()</code></strong></span>, the <code>pct</code> values here are the marginals for the whole table.</p>
</div>
</div><div class="column right" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62" data-source-line-numbers="nil" data-code-line-numbers="2,3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" tabindex="-1"></a>rel_by_region <span class="ot">&lt;-</span> gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion, religion) <span class="sc">|&gt;</span> </span>
<span id="cb62-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">|&gt;</span> </span>
<span id="cb62-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>((n<span class="sc">/</span><span class="fu">sum</span>(n))<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Check</span></span>
<span id="cb63-2"><a aria-hidden="true" tabindex="-1"></a>rel_by_region <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bigregion) <span class="sc">|&gt;</span> </span>
<span id="cb63-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">sum</span>(pct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 4 × 2
  bigregion total
  &lt;fct&gt;     &lt;dbl&gt;
1 Northeast 100  
2 Midwest    99.9
3 South     100  
4 West      100. </code></pre>
</div>
</div>
<div class="tiny">
<p>We get some rounding error because we used <code>round()</code> after summing originally.</p>
</div>
</div></div>
</section>
<section id="two-lessons" class="slide level2">
<h2>Two lessons</h2>
<h3 id="check-your-tables">Check your tables!</h3>
<div>
<ul>
<li class="fragment">Pipelines feed their content forward, so you need to make sure your results are not incorrect.</li>
<li class="fragment">Often, complex tables and graphs can be disturbingly plausible even when wrong.</li>
<li class="fragment">So, figure out what the result should be and test it!</li>
<li class="fragment">Starting with simple or toy cases can help with this process.</li>
</ul>
</div>
</section>
<section id="two-lessons-1" class="slide level2">
<h2>Two lessons</h2>
<h3 id="inspect-your-pipes">Inspect your pipes!</h3>
<div>
<ul>
<li class="fragment">Understand pipelines by running them forward or peeling them back a step at a time.</li>
<li class="fragment">This is a <em>very</em> effective way to understand your own and other people’s code.</li>
</ul>
</div>
</section></section>
<section>
<section id="another-example" class="title-slide slide level1 inv-title center" data-background-color="#252F3E">
<h1>Another example</h1>

</section>
<section id="following-a-pipeline" class="slide level2">
<h2>Following a pipeline</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race, sex, degree) <span class="sc">|&gt;</span> </span>
<span id="cb65-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(), </span>
<span id="cb65-4"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb65-5"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_kids =</span> <span class="fu">mean</span>(childs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb65-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(race <span class="sc">!=</span><span class="st">"Other"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-8"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb65-9"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> mean_kids, <span class="at">y =</span> degree)) <span class="sc">+</span> <span class="co"># Some ggplot ...</span></span>
<span id="cb65-10"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> <span class="fu">facet_grid</span>(sex <span class="sc">~</span> race) <span class="sc">+</span> </span>
<span id="cb65-11"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Average number of Children"</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="03a-dplyr-basics_files/figure-revealjs/03a-dplyr-basics-29-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="following-a-pipeline-1" class="slide level2">
<h2>Following a pipeline</h2>
<div class="columns smallcode">
<div class="column" style="width:38%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:62%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2,867 × 32
    year    id ballot       age childs sibs   degree race  sex   region income16
   &lt;dbl&gt; &lt;dbl&gt; &lt;labelled&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;labe&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   
 1  2016     1 1             47      3 2      Bache… White Male  New E… $170000…
 2  2016     2 2             61      0 3      High … White Male  New E… $50000 …
 3  2016     3 3             72      2 3      Bache… White Male  New E… $75000 …
 4  2016     4 1             43      4 3      High … White Fema… New E… $170000…
 5  2016     5 3             55      2 2      Gradu… White Fema… New E… $170000…
 6  2016     6 2             53      2 2      Junio… White Fema… New E… $60000 …
 7  2016     7 1             50      2 2      High … White Male  New E… $170000…
 8  2016     8 3             23      3 6      High … Other Fema… Middl… $30000 …
 9  2016     9 1             45      3 5      High … Black Male  Middl… $60000 …
10  2016    10 3             71      4 1      Junio… White Male  Middl… $60000 …
# ℹ 2,857 more rows
# ℹ 21 more variables: relig &lt;fct&gt;, marital &lt;fct&gt;, padeg &lt;fct&gt;, madeg &lt;fct&gt;,
#   partyid &lt;fct&gt;, polviews &lt;fct&gt;, happy &lt;fct&gt;, partners &lt;fct&gt;, grass &lt;fct&gt;,
#   zodiac &lt;fct&gt;, pres12 &lt;labelled&gt;, wtssall &lt;dbl&gt;, income_rc &lt;fct&gt;,
#   agegrp &lt;fct&gt;, ageq &lt;fct&gt;, siblings &lt;fct&gt;, kids &lt;fct&gt;, religion &lt;fct&gt;,
#   bigregion &lt;fct&gt;, partners_rc &lt;fct&gt;, obama &lt;dbl&gt;</code></pre>
</div>
</div>
</div></div>
</section>
<section id="following-a-pipeline-2" class="slide level2">
<h2>Following a pipeline</h2>
<div class="columns smallcode">
<div class="column" style="width:38%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb68-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race, sex, degree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:62%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2,867 × 32
# Groups:   race, sex, degree [34]
    year    id ballot       age childs sibs   degree race  sex   region income16
   &lt;dbl&gt; &lt;dbl&gt; &lt;labelled&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;labe&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   
 1  2016     1 1             47      3 2      Bache… White Male  New E… $170000…
 2  2016     2 2             61      0 3      High … White Male  New E… $50000 …
 3  2016     3 3             72      2 3      Bache… White Male  New E… $75000 …
 4  2016     4 1             43      4 3      High … White Fema… New E… $170000…
 5  2016     5 3             55      2 2      Gradu… White Fema… New E… $170000…
 6  2016     6 2             53      2 2      Junio… White Fema… New E… $60000 …
 7  2016     7 1             50      2 2      High … White Male  New E… $170000…
 8  2016     8 3             23      3 6      High … Other Fema… Middl… $30000 …
 9  2016     9 1             45      3 5      High … Black Male  Middl… $60000 …
10  2016    10 3             71      4 1      Junio… White Male  Middl… $60000 …
# ℹ 2,857 more rows
# ℹ 21 more variables: relig &lt;fct&gt;, marital &lt;fct&gt;, padeg &lt;fct&gt;, madeg &lt;fct&gt;,
#   partyid &lt;fct&gt;, polviews &lt;fct&gt;, happy &lt;fct&gt;, partners &lt;fct&gt;, grass &lt;fct&gt;,
#   zodiac &lt;fct&gt;, pres12 &lt;labelled&gt;, wtssall &lt;dbl&gt;, income_rc &lt;fct&gt;,
#   agegrp &lt;fct&gt;, ageq &lt;fct&gt;, siblings &lt;fct&gt;, kids &lt;fct&gt;, religion &lt;fct&gt;,
#   bigregion &lt;fct&gt;, partners_rc &lt;fct&gt;, obama &lt;dbl&gt;</code></pre>
</div>
</div>
</div></div>
</section>
<section id="following-a-pipeline-3" class="slide level2">
<h2>Following a pipeline</h2>
<div class="columns smallcode">
<div class="column" style="width:38%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb70-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race, sex, degree) <span class="sc">|&gt;</span></span>
<span id="cb70-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb70-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_kids =</span> <span class="fu">mean</span>(childs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:62%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 34 × 6
# Groups:   race, sex [6]
   race  sex    degree             n mean_age mean_kids
   &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;          &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;
 1 White Male   Lt High School    96     52.9      2.45
 2 White Male   High School      470     48.8      1.61
 3 White Male   Junior College    65     47.1      1.54
 4 White Male   Bachelor         208     48.6      1.35
 5 White Male   Graduate         112     56.0      1.71
 6 White Female Lt High School   101     55.4      2.81
 7 White Female High School      587     51.9      1.98
 8 White Female Junior College   101     48.2      1.91
 9 White Female Bachelor         218     49.2      1.44
10 White Female Graduate         138     53.6      1.38
# ℹ 24 more rows</code></pre>
</div>
</div>
</div></div>
</section>
<section id="following-a-pipeline-4" class="slide level2">
<h2>Following a pipeline</h2>
<div class="columns smallcode">
<div class="column" style="width:38%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb72-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race, sex, degree) <span class="sc">|&gt;</span></span>
<span id="cb72-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb72-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb72-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_kids =</span> <span class="fu">mean</span>(childs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb72-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:62%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 34 × 7
# Groups:   race, sex [6]
   race  sex    degree             n mean_age mean_kids   pct
   &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;          &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 White Male   Lt High School    96     52.9      2.45 10.1 
 2 White Male   High School      470     48.8      1.61 49.4 
 3 White Male   Junior College    65     47.1      1.54  6.83
 4 White Male   Bachelor         208     48.6      1.35 21.9 
 5 White Male   Graduate         112     56.0      1.71 11.8 
 6 White Female Lt High School   101     55.4      2.81  8.79
 7 White Female High School      587     51.9      1.98 51.1 
 8 White Female Junior College   101     48.2      1.91  8.79
 9 White Female Bachelor         218     49.2      1.44 19.0 
10 White Female Graduate         138     53.6      1.38 12.0 
# ℹ 24 more rows</code></pre>
</div>
</div>
</div></div>
</section>
<section id="following-a-pipeline-5" class="slide level2">
<h2>Following a pipeline</h2>
<div class="columns smallcode">
<div class="column" style="width:38%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race, sex, degree) <span class="sc">|&gt;</span></span>
<span id="cb74-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb74-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_kids =</span> <span class="fu">mean</span>(childs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb74-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb74-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(race <span class="sc">!=</span><span class="st">"Other"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:62%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 23 × 7
# Groups:   race, sex [4]
   race  sex    degree             n mean_age mean_kids   pct
   &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;          &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 White Male   Lt High School    96     52.9      2.45 10.1 
 2 White Male   High School      470     48.8      1.61 49.4 
 3 White Male   Junior College    65     47.1      1.54  6.83
 4 White Male   Bachelor         208     48.6      1.35 21.9 
 5 White Male   Graduate         112     56.0      1.71 11.8 
 6 White Female Lt High School   101     55.4      2.81  8.79
 7 White Female High School      587     51.9      1.98 51.1 
 8 White Female Junior College   101     48.2      1.91  8.79
 9 White Female Bachelor         218     49.2      1.44 19.0 
10 White Female Graduate         138     53.6      1.38 12.0 
# ℹ 13 more rows</code></pre>
</div>
</div>
</div></div>
</section>
<section id="following-a-pipeline-6" class="slide level2">
<h2>Following a pipeline</h2>
<div class="columns smallcode">
<div class="column" style="width:38%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb76-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race, sex, degree) <span class="sc">|&gt;</span></span>
<span id="cb76-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb76-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb76-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_kids =</span> <span class="fu">mean</span>(childs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb76-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(race <span class="sc">!=</span><span class="st">"Other"</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-8"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:62%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 20 × 7
# Groups:   race, sex [4]
   race  sex    degree             n mean_age mean_kids   pct
   &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;          &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 White Male   Lt High School    96     52.9      2.45 10.1 
 2 White Male   High School      470     48.8      1.61 49.4 
 3 White Male   Junior College    65     47.1      1.54  6.83
 4 White Male   Bachelor         208     48.6      1.35 21.9 
 5 White Male   Graduate         112     56.0      1.71 11.8 
 6 White Female Lt High School   101     55.4      2.81  8.79
 7 White Female High School      587     51.9      1.98 51.1 
 8 White Female Junior College   101     48.2      1.91  8.79
 9 White Female Bachelor         218     49.2      1.44 19.0 
10 White Female Graduate         138     53.6      1.38 12.0 
11 Black Male   Lt High School    17     56.1      3     8.21
12 Black Male   High School      142     43.6      1.96 68.6 
13 Black Male   Junior College    16     47.1      1.31  7.73
14 Black Male   Bachelor          22     41.6      1.14 10.6 
15 Black Male   Graduate           8     53.1      1.88  3.86
16 Black Female Lt High School    43     51.0      2.91 15.2 
17 Black Female High School      150     43.1      2.14 53.0 
18 Black Female Junior College    17     45.8      1.82  6.01
19 Black Female Bachelor          49     47.0      1.76 17.3 
20 Black Female Graduate          23     51.2      1.74  8.13</code></pre>
</div>
</div>
</div></div>
</section>
<section id="following-a-pipeline-7" class="slide level2">
<h2>Following a pipeline</h2>
<div class="columns smallcode">
<div class="column" style="width:38%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span></span>
<span id="cb78-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race, sex, degree) <span class="sc">|&gt;</span></span>
<span id="cb78-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb78-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb78-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_kids =</span> <span class="fu">mean</span>(childs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb78-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(race <span class="sc">!=</span><span class="st">"Other"</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-8"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb78-9"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">grp_totpct =</span> <span class="fu">sum</span>(pct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:62%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 4 × 3
# Groups:   race [2]
  race  sex    grp_totpct
  &lt;fct&gt; &lt;fct&gt;       &lt;dbl&gt;
1 White Male        100  
2 White Female       99.7
3 Black Male         99.0
4 Black Female       99.6</code></pre>
</div>
</div>
</div></div>
</section></section>
<section>
<section id="conditional-selection" class="title-slide slide level1 inv-title center" data-background-color="#252F3E">
<h1>Conditional selection</h1>

</section>
<section id="conditionals-in-select-filter" class="slide level2">
<h2>Conditionals in <span class="fg-green"><code>select()</code></span> &amp; <span class="fg-green"><code>filter()</code></span></h2>
<ul>
<li>Some new data, this time on national rates of cadaveric organ donation:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># library(socviz)</span></span>
<span id="cb80-2"><a aria-hidden="true" tabindex="-1"></a>organdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 238 × 21
   country   year       donors   pop pop_dens   gdp gdp_lag health health_lag
   &lt;chr&gt;     &lt;date&gt;      &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;
 1 Australia NA          NA    17065    0.220 16774   16591   1300       1224
 2 Australia 1991-01-01  12.1  17284    0.223 17171   16774   1379       1300
 3 Australia 1992-01-01  12.4  17495    0.226 17914   17171   1455       1379
 4 Australia 1993-01-01  12.5  17667    0.228 18883   17914   1540       1455
 5 Australia 1994-01-01  10.2  17855    0.231 19849   18883   1626       1540
 6 Australia 1995-01-01  10.2  18072    0.233 21079   19849   1737       1626
 7 Australia 1996-01-01  10.6  18311    0.237 21923   21079   1846       1737
 8 Australia 1997-01-01  10.3  18518    0.239 22961   21923   1948       1846
 9 Australia 1998-01-01  10.5  18711    0.242 24148   22961   2077       1948
10 Australia 1999-01-01   8.67 18926    0.244 25445   24148   2231       2077
# ℹ 228 more rows
# ℹ 12 more variables: pubhealth &lt;dbl&gt;, roads &lt;dbl&gt;, cerebvas &lt;int&gt;,
#   assault &lt;int&gt;, external &lt;int&gt;, txp_pop &lt;dbl&gt;, world &lt;chr&gt;, opt &lt;chr&gt;,
#   consent_law &lt;chr&gt;, consent_practice &lt;chr&gt;, consistent &lt;chr&gt;, ccode &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="conditionals-in-select-filter-1" class="slide level2">
<h2>Conditionals in <span class="fg-green"><code>select()</code></span> &amp; <span class="fg-green"><code>filter()</code></span></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb82-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(consent_law <span class="sc">==</span> <span class="st">"Informed"</span> <span class="sc">&amp;</span> donors <span class="sc">&gt;</span> <span class="dv">15</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 30 × 21
   country year       donors   pop pop_dens   gdp gdp_lag health health_lag
   &lt;chr&gt;   &lt;date&gt;      &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;
 1 Canada  2000-01-01   15.3 30770    0.309 28472   26658   2541       2400
 2 Denmark 1992-01-01   16.1  5171   12.0   19644   19126   1660       1603
 3 Ireland 1991-01-01   19    3534    5.03  13495   12917    884        791
 4 Ireland 1992-01-01   19.5  3558    5.06  14241   13495   1005        884
 5 Ireland 1993-01-01   17.1  3576    5.09  14927   14241   1041       1005
 6 Ireland 1994-01-01   20.3  3590    5.11  15990   14927   1119       1041
 7 Ireland 1995-01-01   24.6  3609    5.14  17789   15990   1208       1119
 8 Ireland 1996-01-01   16.8  3636    5.17  19245   17789   1269       1208
 9 Ireland 1997-01-01   20.9  3673    5.23  22017   19245   1417       1269
10 Ireland 1998-01-01   23.8  3715    5.29  23995   22017   1487       1417
# ℹ 20 more rows
# ℹ 12 more variables: pubhealth &lt;dbl&gt;, roads &lt;dbl&gt;, cerebvas &lt;int&gt;,
#   assault &lt;int&gt;, external &lt;int&gt;, txp_pop &lt;dbl&gt;, world &lt;chr&gt;, opt &lt;chr&gt;,
#   consent_law &lt;chr&gt;, consent_practice &lt;chr&gt;, consistent &lt;chr&gt;, ccode &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="conditionals-in-select-filter-2" class="slide level2">
<h2>Conditionals in <span class="fg-green"><code>select()</code></span> &amp; <span class="fg-green"><code>filter()</code></span></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84" data-source-line-numbers="nil" data-code-line-numbers="2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb84-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, <span class="fu">where</span>(is.integer)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 238 × 8
   country   year         pop   gdp gdp_lag cerebvas assault external
   &lt;chr&gt;     &lt;date&gt;     &lt;int&gt; &lt;int&gt;   &lt;int&gt;    &lt;int&gt;   &lt;int&gt;    &lt;int&gt;
 1 Australia NA         17065 16774   16591      682      21      444
 2 Australia 1991-01-01 17284 17171   16774      647      19      425
 3 Australia 1992-01-01 17495 17914   17171      630      17      406
 4 Australia 1993-01-01 17667 18883   17914      611      18      376
 5 Australia 1994-01-01 17855 19849   18883      631      17      387
 6 Australia 1995-01-01 18072 21079   19849      592      16      371
 7 Australia 1996-01-01 18311 21923   21079      576      17      395
 8 Australia 1997-01-01 18518 22961   21923      525      17      385
 9 Australia 1998-01-01 18711 24148   22961      516      16      410
10 Australia 1999-01-01 18926 25445   24148      493      15      409
# ℹ 228 more rows</code></pre>
</div>
</div>
<p>Use <span class="fg-green"><strong><code>where()</code></strong></span> to test columns.</p>
</section>
<section id="conditionals-in-select-filter-3" class="slide level2">
<h2>Conditionals in <span class="fg-green"><code>select()</code></span> &amp; <span class="fg-green"><code>filter()</code></span></h2>
<p>When telling <span class="fg-green"><strong><code>where()</code></strong></span> to use <span class="fg-green"><strong><code>is.integer()</code></strong></span> to test each column, we don’t put parentheses at the end of its name. If we did, R would try to evaluate <span class="fg-green"><strong><code>is.integer()</code></strong></span> right then, and fail:</p>
<div class="sourceCode" id="cb86" data-code-line-numbers=""><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> organdata <span class="sc">|&gt;</span> </span>
<span id="cb86-2"><a aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(country, year, <span class="fu">where</span>(<span class="fu">is.integer</span>()))</span>
<span id="cb86-3"><a aria-hidden="true" tabindex="-1"></a>Error<span class="sc">:</span> <span class="dv">0</span> arguments passed to <span class="st">'is.integer'</span> which requires <span class="dv">1</span></span>
<span id="cb86-4"><a aria-hidden="true" tabindex="-1"></a>Run <span class="st">`</span><span class="at">rlang::last_error()</span><span class="st">`</span> to see where the error occurred.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is true in similar situations elsewhere as well.</p>
</section>
<section id="conditionals-in-select-filter-4" class="slide level2">
<h2>Conditionals in <span class="fg-green"><code>select()</code></span> &amp; <span class="fg-green"><code>filter()</code></span></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb87-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, <span class="fu">where</span>(is.character))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 238 × 8
   country  year       world opt   consent_law consent_practice consistent ccode
   &lt;chr&gt;    &lt;date&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;
 1 Austral… NA         Libe… In    Informed    Informed         Yes        Oz   
 2 Austral… 1991-01-01 Libe… In    Informed    Informed         Yes        Oz   
 3 Austral… 1992-01-01 Libe… In    Informed    Informed         Yes        Oz   
 4 Austral… 1993-01-01 Libe… In    Informed    Informed         Yes        Oz   
 5 Austral… 1994-01-01 Libe… In    Informed    Informed         Yes        Oz   
 6 Austral… 1995-01-01 Libe… In    Informed    Informed         Yes        Oz   
 7 Austral… 1996-01-01 Libe… In    Informed    Informed         Yes        Oz   
 8 Austral… 1997-01-01 Libe… In    Informed    Informed         Yes        Oz   
 9 Austral… 1998-01-01 Libe… In    Informed    Informed         Yes        Oz   
10 Austral… 1999-01-01 Libe… In    Informed    Informed         Yes        Oz   
# ℹ 228 more rows</code></pre>
</div>
</div>
<p>We have functions like e.g.&nbsp;<span class="fg-green"><strong><code>is.character()</code></strong></span>, <span class="fg-green"><strong><code>is.numeric()</code></strong></span>, <span class="fg-green"><strong><code>is.logical()</code></strong></span>, <span class="fg-green"><strong><code>is.factor()</code></strong></span>, etc. All return either <span class="fg-green"><code>TRUE</code></span> or <span class="fg-red"><code>FALSE</code></span>.</p>
</section>
<section id="conditionals-in-select-filter-5" class="slide level2">
<h2>Conditionals in <span class="fg-green"><code>select()</code></span> &amp; <span class="fg-green"><code>filter()</code></span></h2>
<p>Sometimes we don’t pass a function, but do want to use the result of one:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb89" data-source-line-numbers="nil" data-code-line-numbers="2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb89-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, <span class="fu">starts_with</span>(<span class="st">"gdp"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 238 × 4
   country   year         gdp gdp_lag
   &lt;chr&gt;     &lt;date&gt;     &lt;int&gt;   &lt;int&gt;
 1 Australia NA         16774   16591
 2 Australia 1991-01-01 17171   16774
 3 Australia 1992-01-01 17914   17171
 4 Australia 1993-01-01 18883   17914
 5 Australia 1994-01-01 19849   18883
 6 Australia 1995-01-01 21079   19849
 7 Australia 1996-01-01 21923   21079
 8 Australia 1997-01-01 22961   21923
 9 Australia 1998-01-01 24148   22961
10 Australia 1999-01-01 25445   24148
# ℹ 228 more rows</code></pre>
</div>
</div>
<div class="tiny">
<p>We have <span class="fg-green"><strong><code>starts_with()</code></strong></span>, <span class="fg-green"><strong><code>ends_with()</code></strong></span>, <span class="fg-green"><strong><code>contains()</code></strong></span>, <span class="fg-green"><strong><code>matches()</code></strong></span>, and <span class="fg-green"><strong><code>num_range()</code></strong></span>. Collectively these are “<span class="fg-pink">tidy selectors</span>”.</p>
</div>
</section>
<section id="conditionals-in-select-filter-6" class="slide level2">
<h2>Conditionals in <span class="fg-green"><code>select()</code></span> &amp; <span class="fg-green"><code>filter()</code></span></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb91-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Australia"</span> <span class="sc">|</span> country <span class="sc">==</span> <span class="st">"Canada"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 28 × 21
   country   year       donors   pop pop_dens   gdp gdp_lag health health_lag
   &lt;chr&gt;     &lt;date&gt;      &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;
 1 Australia NA          NA    17065    0.220 16774   16591   1300       1224
 2 Australia 1991-01-01  12.1  17284    0.223 17171   16774   1379       1300
 3 Australia 1992-01-01  12.4  17495    0.226 17914   17171   1455       1379
 4 Australia 1993-01-01  12.5  17667    0.228 18883   17914   1540       1455
 5 Australia 1994-01-01  10.2  17855    0.231 19849   18883   1626       1540
 6 Australia 1995-01-01  10.2  18072    0.233 21079   19849   1737       1626
 7 Australia 1996-01-01  10.6  18311    0.237 21923   21079   1846       1737
 8 Australia 1997-01-01  10.3  18518    0.239 22961   21923   1948       1846
 9 Australia 1998-01-01  10.5  18711    0.242 24148   22961   2077       1948
10 Australia 1999-01-01   8.67 18926    0.244 25445   24148   2231       2077
# ℹ 18 more rows
# ℹ 12 more variables: pubhealth &lt;dbl&gt;, roads &lt;dbl&gt;, cerebvas &lt;int&gt;,
#   assault &lt;int&gt;, external &lt;int&gt;, txp_pop &lt;dbl&gt;, world &lt;chr&gt;, opt &lt;chr&gt;,
#   consent_law &lt;chr&gt;, consent_practice &lt;chr&gt;, consistent &lt;chr&gt;, ccode &lt;chr&gt;</code></pre>
</div>
</div>
<p>This could get cumbersome fast.</p>
</section>
<section id="use-in-for-multiple-selections" class="slide level2">
<h2>Use <span class="fg-pink"><code>%in%</code></span> for multiple selections</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb93" data-source-line-numbers="nil" data-code-line-numbers="4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a aria-hidden="true" tabindex="-1"></a>my_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Australia"</span>, <span class="st">"Canada"</span>, <span class="st">"United States"</span>, <span class="st">"Ireland"</span>)</span>
<span id="cb93-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb93-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> my_countries) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 56 × 21
   country   year       donors   pop pop_dens   gdp gdp_lag health health_lag
   &lt;chr&gt;     &lt;date&gt;      &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;
 1 Australia NA          NA    17065    0.220 16774   16591   1300       1224
 2 Australia 1991-01-01  12.1  17284    0.223 17171   16774   1379       1300
 3 Australia 1992-01-01  12.4  17495    0.226 17914   17171   1455       1379
 4 Australia 1993-01-01  12.5  17667    0.228 18883   17914   1540       1455
 5 Australia 1994-01-01  10.2  17855    0.231 19849   18883   1626       1540
 6 Australia 1995-01-01  10.2  18072    0.233 21079   19849   1737       1626
 7 Australia 1996-01-01  10.6  18311    0.237 21923   21079   1846       1737
 8 Australia 1997-01-01  10.3  18518    0.239 22961   21923   1948       1846
 9 Australia 1998-01-01  10.5  18711    0.242 24148   22961   2077       1948
10 Australia 1999-01-01   8.67 18926    0.244 25445   24148   2231       2077
# ℹ 46 more rows
# ℹ 12 more variables: pubhealth &lt;dbl&gt;, roads &lt;dbl&gt;, cerebvas &lt;int&gt;,
#   assault &lt;int&gt;, external &lt;int&gt;, txp_pop &lt;dbl&gt;, world &lt;chr&gt;, opt &lt;chr&gt;,
#   consent_law &lt;chr&gt;, consent_practice &lt;chr&gt;, consistent &lt;chr&gt;, ccode &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="negating-in" class="slide level2">
<h2>Negating <span class="fg-pink"><code>%in%</code></span></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb95" data-source-line-numbers="nil" data-code-line-numbers="4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a aria-hidden="true" tabindex="-1"></a>my_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Australia"</span>, <span class="st">"Canada"</span>, <span class="st">"United States"</span>, <span class="st">"Ireland"</span>)</span>
<span id="cb95-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb95-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(country <span class="sc">%in%</span> my_countries)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 182 × 21
   country year       donors   pop pop_dens   gdp gdp_lag health health_lag
   &lt;chr&gt;   &lt;date&gt;      &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;
 1 Austria NA           NA    7678     9.16 18914   17425   1344       1255
 2 Austria 1991-01-01   27.6  7755     9.25 19860   18914   1419       1344
 3 Austria 1992-01-01   23.1  7841     9.35 20601   19860   1551       1419
 4 Austria 1993-01-01   26.2  7906     9.43 21119   20601   1674       1551
 5 Austria 1994-01-01   21.4  7936     9.46 21940   21119   1739       1674
 6 Austria 1995-01-01   21.5  7948     9.48 22817   21940   1865       1739
 7 Austria 1996-01-01   24.7  7959     9.49 23798   22817   1986       1865
 8 Austria 1997-01-01   19.5  7968     9.50 24364   23798   1848       1986
 9 Austria 1998-01-01   20.7  7977     9.51 25423   24364   1953       1848
10 Austria 1999-01-01   25.9  7992     9.53 26513   25423   2069       1953
# ℹ 172 more rows
# ℹ 12 more variables: pubhealth &lt;dbl&gt;, roads &lt;dbl&gt;, cerebvas &lt;int&gt;,
#   assault &lt;int&gt;, external &lt;int&gt;, txp_pop &lt;dbl&gt;, world &lt;chr&gt;, opt &lt;chr&gt;,
#   consent_law &lt;chr&gt;, consent_practice &lt;chr&gt;, consistent &lt;chr&gt;, ccode &lt;chr&gt;</code></pre>
</div>
</div>
<p>Also a bit awkward. There’s no built-in “Not in” operator.</p>
</section>
<section id="a-custom-operator" class="slide level2">
<h2>A custom operator</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb97" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">%nin%</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">Negate</span>(<span class="st">`</span><span class="at">%in%</span><span class="st">`</span>) <span class="co"># this operator is included in the socviz package</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98" data-source-line-numbers="nil" data-code-line-numbers="2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb98-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%nin%</span> my_countries) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 182 × 21
   country year       donors   pop pop_dens   gdp gdp_lag health health_lag
   &lt;chr&gt;   &lt;date&gt;      &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;
 1 Austria NA           NA    7678     9.16 18914   17425   1344       1255
 2 Austria 1991-01-01   27.6  7755     9.25 19860   18914   1419       1344
 3 Austria 1992-01-01   23.1  7841     9.35 20601   19860   1551       1419
 4 Austria 1993-01-01   26.2  7906     9.43 21119   20601   1674       1551
 5 Austria 1994-01-01   21.4  7936     9.46 21940   21119   1739       1674
 6 Austria 1995-01-01   21.5  7948     9.48 22817   21940   1865       1739
 7 Austria 1996-01-01   24.7  7959     9.49 23798   22817   1986       1865
 8 Austria 1997-01-01   19.5  7968     9.50 24364   23798   1848       1986
 9 Austria 1998-01-01   20.7  7977     9.51 25423   24364   1953       1848
10 Austria 1999-01-01   25.9  7992     9.53 26513   25423   2069       1953
# ℹ 172 more rows
# ℹ 12 more variables: pubhealth &lt;dbl&gt;, roads &lt;dbl&gt;, cerebvas &lt;int&gt;,
#   assault &lt;int&gt;, external &lt;int&gt;, txp_pop &lt;dbl&gt;, world &lt;chr&gt;, opt &lt;chr&gt;,
#   consent_law &lt;chr&gt;, consent_practice &lt;chr&gt;, consistent &lt;chr&gt;, ccode &lt;chr&gt;</code></pre>
</div>
</div>
<aside><div>
<p>The backticks are special here because we need to name an operator.</p>
</div></aside></section></section>
<section>
<section id="using-across" class="title-slide slide level1 inv-title center" data-background-color="#252F3E">
<h1>Using <code>across()</code></h1>

</section>
<section id="do-more-than-one-thing" class="slide level2">
<h2>Do more than one thing</h2>
<p>Earlier we saw this:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a aria-hidden="true" tabindex="-1"></a>gss_sm <span class="sc">|&gt;</span> </span>
<span id="cb100-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race, sex, degree) <span class="sc">|&gt;</span> </span>
<span id="cb100-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(), </span>
<span id="cb100-4"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb100-5"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_kids =</span> <span class="fu">mean</span>(childs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 34 × 6
# Groups:   race, sex [6]
   race  sex    degree             n mean_age mean_kids
   &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;          &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;
 1 White Male   Lt High School    96     52.9      2.45
 2 White Male   High School      470     48.8      1.61
 3 White Male   Junior College    65     47.1      1.54
 4 White Male   Bachelor         208     48.6      1.35
 5 White Male   Graduate         112     56.0      1.71
 6 White Female Lt High School   101     55.4      2.81
 7 White Female High School      587     51.9      1.98
 8 White Female Junior College   101     48.2      1.91
 9 White Female Bachelor         218     49.2      1.44
10 White Female Graduate         138     53.6      1.38
# ℹ 24 more rows</code></pre>
</div>
</div>
</section>
<section id="do-more-than-one-thing-1" class="slide level2">
<h2>Do more than one thing</h2>
<p>Similarly for <code>organdata</code> we might want to do:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span>  </span>
<span id="cb102-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country) <span class="sc">|&gt;</span></span>
<span id="cb102-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">donors_mean =</span> <span class="fu">mean</span>(donors, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-4"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">donors_sd =</span> <span class="fu">sd</span>(donors, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-5"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-6"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">health_mean =</span> <span class="fu">mean</span>(health, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-7"><a aria-hidden="true" tabindex="-1"></a>            <span class="at">roads_mean =</span> <span class="fu">mean</span>(roads, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 17 × 7
# Groups:   consent_law [2]
   consent_law country     donors_mean donors_sd gdp_mean health_mean roads_mean
   &lt;chr&gt;       &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
 1 Informed    Australia          10.6     1.14    22179.       1958.      105. 
 2 Informed    Canada             14.0     0.751   23711.       2272.      109. 
 3 Informed    Denmark            13.1     1.47    23722.       2054.      102. 
 4 Informed    Germany            13.0     0.611   22163.       2349.      113. 
 5 Informed    Ireland            19.8     2.48    20824.       1480.      118. 
 6 Informed    Netherlands        13.7     1.55    23013.       1993.       76.1
 7 Informed    United Kin…        13.5     0.775   21359.       1561.       67.9
 8 Informed    United Sta…        20.0     1.33    29212.       3988.      155. 
 9 Presumed    Austria            23.5     2.42    23876.       1875.      150. 
10 Presumed    Belgium            21.9     1.94    22500.       1958.      155. 
11 Presumed    Finland            18.4     1.53    21019.       1615.       93.6
12 Presumed    France             16.8     1.60    22603.       2160.      156. 
13 Presumed    Italy              11.1     4.28    21554.       1757       122. 
14 Presumed    Norway             15.4     1.11    26448.       2217.       70.0
15 Presumed    Spain              28.1     4.96    16933        1289.      161. 
16 Presumed    Sweden             13.1     1.75    22415.       1951.       72.3
17 Presumed    Switzerland        14.2     1.71    27233        2776.       96.4</code></pre>
</div>
</div>
<p>This works, but it’s really tedious. Also error-prone.</p>
</section>
<section id="use-across" class="slide level2">
<h2>Use <span class="fg-green"><strong><code>across()</code></strong></span></h2>
<p>Instead, use <span class="fg-green"><code>across()</code></span> to apply a function to more than one column.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a aria-hidden="true" tabindex="-1"></a>my_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gdp"</span>, <span class="st">"donors"</span>, <span class="st">"roads"</span>)</span>
<span id="cb104-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a aria-hidden="true" tabindex="-1"></a><span class="do">## nested parens again, but it's worth it</span></span>
<span id="cb104-4"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb104-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country) <span class="sc">|&gt;</span></span>
<span id="cb104-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(my_vars),           </span>
<span id="cb104-7"><a aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="at">avg =</span> \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb104-8"><a aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb104-9"><a aria-hidden="true" tabindex="-1"></a>           )     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 17 × 5
# Groups:   consent_law [2]
   consent_law country        gdp_avg donors_avg roads_avg
   &lt;chr&gt;       &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1 Informed    Australia       22179.       10.6     105. 
 2 Informed    Canada          23711.       14.0     109. 
 3 Informed    Denmark         23722.       13.1     102. 
 4 Informed    Germany         22163.       13.0     113. 
 5 Informed    Ireland         20824.       19.8     118. 
 6 Informed    Netherlands     23013.       13.7      76.1
 7 Informed    United Kingdom  21359.       13.5      67.9
 8 Informed    United States   29212.       20.0     155. 
 9 Presumed    Austria         23876.       23.5     150. 
10 Presumed    Belgium         22500.       21.9     155. 
11 Presumed    Finland         21019.       18.4      93.6
12 Presumed    France          22603.       16.8     156. 
13 Presumed    Italy           21554.       11.1     122. 
14 Presumed    Norway          26448.       15.4      70.0
15 Presumed    Spain           16933        28.1     161. 
16 Presumed    Sweden          22415.       13.1      72.3
17 Presumed    Switzerland     27233        14.2      96.4</code></pre>
</div>
</div>
</section>
<section id="lets-look-at-that-again" class="slide level2">
<h2>Let’s look at that again</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb106" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a aria-hidden="true" tabindex="-1"></a>my_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gdp"</span>, <span class="st">"donors"</span>, <span class="st">"roads"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">

</div></div>
</section>
<section id="lets-look-at-that-again-1" class="slide level2">
<h2>Let’s look at that again</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb107" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a aria-hidden="true" tabindex="-1"></a>my_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gdp"</span>, <span class="st">"donors"</span>, <span class="st">"roads"</span>)</span>
<span id="cb107-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a aria-hidden="true" tabindex="-1"></a><span class="do">## nested parens again, but it's worth it</span></span>
<span id="cb107-4"><a aria-hidden="true" tabindex="-1"></a>organdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 238 × 21
   country   year       donors   pop pop_dens   gdp gdp_lag health health_lag
   &lt;chr&gt;     &lt;date&gt;      &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;
 1 Australia NA          NA    17065    0.220 16774   16591   1300       1224
 2 Australia 1991-01-01  12.1  17284    0.223 17171   16774   1379       1300
 3 Australia 1992-01-01  12.4  17495    0.226 17914   17171   1455       1379
 4 Australia 1993-01-01  12.5  17667    0.228 18883   17914   1540       1455
 5 Australia 1994-01-01  10.2  17855    0.231 19849   18883   1626       1540
 6 Australia 1995-01-01  10.2  18072    0.233 21079   19849   1737       1626
 7 Australia 1996-01-01  10.6  18311    0.237 21923   21079   1846       1737
 8 Australia 1997-01-01  10.3  18518    0.239 22961   21923   1948       1846
 9 Australia 1998-01-01  10.5  18711    0.242 24148   22961   2077       1948
10 Australia 1999-01-01   8.67 18926    0.244 25445   24148   2231       2077
# ℹ 228 more rows
# ℹ 12 more variables: pubhealth &lt;dbl&gt;, roads &lt;dbl&gt;, cerebvas &lt;int&gt;,
#   assault &lt;int&gt;, external &lt;int&gt;, txp_pop &lt;dbl&gt;, world &lt;chr&gt;, opt &lt;chr&gt;,
#   consent_law &lt;chr&gt;, consent_practice &lt;chr&gt;, consistent &lt;chr&gt;, ccode &lt;chr&gt;</code></pre>
</div>
</div>
</div></div>
</section>
<section id="lets-look-at-that-again-2" class="slide level2">
<h2>Let’s look at that again</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb109" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a aria-hidden="true" tabindex="-1"></a>my_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gdp"</span>, <span class="st">"donors"</span>, <span class="st">"roads"</span>)</span>
<span id="cb109-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a aria-hidden="true" tabindex="-1"></a><span class="do">## nested parens again, but it's worth it</span></span>
<span id="cb109-4"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span></span>
<span id="cb109-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 238 × 21
# Groups:   consent_law, country [17]
   country   year       donors   pop pop_dens   gdp gdp_lag health health_lag
   &lt;chr&gt;     &lt;date&gt;      &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;
 1 Australia NA          NA    17065    0.220 16774   16591   1300       1224
 2 Australia 1991-01-01  12.1  17284    0.223 17171   16774   1379       1300
 3 Australia 1992-01-01  12.4  17495    0.226 17914   17171   1455       1379
 4 Australia 1993-01-01  12.5  17667    0.228 18883   17914   1540       1455
 5 Australia 1994-01-01  10.2  17855    0.231 19849   18883   1626       1540
 6 Australia 1995-01-01  10.2  18072    0.233 21079   19849   1737       1626
 7 Australia 1996-01-01  10.6  18311    0.237 21923   21079   1846       1737
 8 Australia 1997-01-01  10.3  18518    0.239 22961   21923   1948       1846
 9 Australia 1998-01-01  10.5  18711    0.242 24148   22961   2077       1948
10 Australia 1999-01-01   8.67 18926    0.244 25445   24148   2231       2077
# ℹ 228 more rows
# ℹ 12 more variables: pubhealth &lt;dbl&gt;, roads &lt;dbl&gt;, cerebvas &lt;int&gt;,
#   assault &lt;int&gt;, external &lt;int&gt;, txp_pop &lt;dbl&gt;, world &lt;chr&gt;, opt &lt;chr&gt;,
#   consent_law &lt;chr&gt;, consent_practice &lt;chr&gt;, consistent &lt;chr&gt;, ccode &lt;chr&gt;</code></pre>
</div>
</div>
</div></div>
</section>
<section id="lets-look-at-that-again-3" class="slide level2">
<h2>Let’s look at that again</h2>
<div class="columns smallcode">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb111" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a aria-hidden="true" tabindex="-1"></a>my_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gdp"</span>, <span class="st">"donors"</span>, <span class="st">"roads"</span>)</span>
<span id="cb111-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a aria-hidden="true" tabindex="-1"></a><span class="do">## nested parens again, but it's worth it</span></span>
<span id="cb111-4"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span></span>
<span id="cb111-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country) <span class="sc">|&gt;</span></span>
<span id="cb111-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(my_vars),</span>
<span id="cb111-7"><a aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="at">avg =</span> \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb111-8"><a aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb111-9"><a aria-hidden="true" tabindex="-1"></a>           )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 17 × 5
# Groups:   consent_law [2]
   consent_law country        gdp_avg donors_avg roads_avg
   &lt;chr&gt;       &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1 Informed    Australia       22179.       10.6     105. 
 2 Informed    Canada          23711.       14.0     109. 
 3 Informed    Denmark         23722.       13.1     102. 
 4 Informed    Germany         22163.       13.0     113. 
 5 Informed    Ireland         20824.       19.8     118. 
 6 Informed    Netherlands     23013.       13.7      76.1
 7 Informed    United Kingdom  21359.       13.5      67.9
 8 Informed    United States   29212.       20.0     155. 
 9 Presumed    Austria         23876.       23.5     150. 
10 Presumed    Belgium         22500.       21.9     155. 
11 Presumed    Finland         21019.       18.4      93.6
12 Presumed    France          22603.       16.8     156. 
13 Presumed    Italy           21554.       11.1     122. 
14 Presumed    Norway          26448.       15.4      70.0
15 Presumed    Spain           16933        28.1     161. 
16 Presumed    Sweden          22415.       13.1      72.3
17 Presumed    Switzerland     27233        14.2      96.4</code></pre>
</div>
</div>
</div></div>
<div>
<ul>
<li class="fragment"><code>my_vars</code> are selected by <span class="fg-green"><strong><code>across()</code></strong></span></li>
<li class="fragment">We use <code>all_of()</code> or <code>any_of()</code> to be explicit</li>
<li class="fragment"><span class="fg-green"><strong><code>list()</code></strong></span> of the form <code>result = function</code> gives the new columns that will be calculated.</li>
<li class="fragment">The thing inside the list is an <em>anonymous function</em> with the “waving person”</li>
</ul>
</div>
</section>
<section id="we-can-calculate-more-than-one-thing" class="slide level2">
<h2>We can calculate more than one thing</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb113" data-source-line-numbers="nil" data-code-line-numbers="6,7,8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a aria-hidden="true" tabindex="-1"></a>my_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gdp"</span>, <span class="st">"donors"</span>, <span class="st">"roads"</span>)</span>
<span id="cb113-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb113-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country) <span class="sc">|&gt;</span></span>
<span id="cb113-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(my_vars),           </span>
<span id="cb113-6"><a aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="at">avg =</span> \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb113-7"><a aria-hidden="true" tabindex="-1"></a>                        <span class="at">sd =</span> \(x) <span class="fu">var</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb113-8"><a aria-hidden="true" tabindex="-1"></a>                        <span class="at">md =</span> \(x) <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb113-9"><a aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb113-10"><a aria-hidden="true" tabindex="-1"></a>           )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 17 × 11
# Groups:   consent_law [2]
   consent_law country      gdp_avg gdp_sd gdp_md donors_avg donors_sd donors_md
   &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt;  &lt;int&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 Informed    Australia     22179. 1.57e7  21923       10.6     1.31       10.4
 2 Informed    Canada        23711. 1.57e7  22764       14.0     0.564      14.0
 3 Informed    Denmark       23722. 1.52e7  23548       13.1     2.16       12.9
 4 Informed    Germany       22163. 6.26e6  22164       13.0     0.374      13  
 5 Informed    Ireland       20824. 4.45e7  19245       19.8     6.14       19.2
 6 Informed    Netherlands   23013. 1.42e7  22541       13.7     2.41       13.8
 7 Informed    United King…  21359. 1.54e7  20839       13.5     0.601      13.5
 8 Informed    United Stat…  29212. 2.09e7  28772       20.0     1.76       20.1
 9 Presumed    Austria       23876. 1.12e7  23798       23.5     5.84       23.8
10 Presumed    Belgium       22500. 1.01e7  22152       21.9     3.75       21.4
11 Presumed    Finland       21019. 1.35e7  19842       18.4     2.33       19.4
12 Presumed    France        22603. 1.06e7  21990       16.8     2.55       16.6
13 Presumed    Italy         21554. 7.74e6  21396       11.1    18.3        11.3
14 Presumed    Norway        26448. 4.21e7  26218       15.4     1.23       15.4
15 Presumed    Spain         16933  8.34e6  16416       28.1    24.6        28  
16 Presumed    Sweden        22415. 1.03e7  22029       13.1     3.07       12.7
17 Presumed    Switzerland   27233  4.64e6  26304       14.2     2.92       14.4
# ℹ 3 more variables: roads_avg &lt;dbl&gt;, roads_sd &lt;dbl&gt;, roads_md &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="its-ok-to-use-the-function-names" class="slide level2">
<h2>It’s OK to use the function names</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb115" data-source-line-numbers="nil" data-code-line-numbers="6,7,8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a aria-hidden="true" tabindex="-1"></a>my_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gdp"</span>, <span class="st">"donors"</span>, <span class="st">"roads"</span>)</span>
<span id="cb115-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb115-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country) <span class="sc">|&gt;</span></span>
<span id="cb115-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(my_vars),           </span>
<span id="cb115-6"><a aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="at">mean =</span> \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb115-7"><a aria-hidden="true" tabindex="-1"></a>                        <span class="at">var =</span> \(x) <span class="fu">var</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb115-8"><a aria-hidden="true" tabindex="-1"></a>                        <span class="at">median =</span> \(x) <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb115-9"><a aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb115-10"><a aria-hidden="true" tabindex="-1"></a>           )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 17 × 11
# Groups:   consent_law [2]
   consent_law country        gdp_mean gdp_var gdp_median donors_mean donors_var
   &lt;chr&gt;       &lt;chr&gt;             &lt;dbl&gt;   &lt;dbl&gt;      &lt;int&gt;       &lt;dbl&gt;      &lt;dbl&gt;
 1 Informed    Australia        22179.  1.57e7      21923        10.6      1.31 
 2 Informed    Canada           23711.  1.57e7      22764        14.0      0.564
 3 Informed    Denmark          23722.  1.52e7      23548        13.1      2.16 
 4 Informed    Germany          22163.  6.26e6      22164        13.0      0.374
 5 Informed    Ireland          20824.  4.45e7      19245        19.8      6.14 
 6 Informed    Netherlands      23013.  1.42e7      22541        13.7      2.41 
 7 Informed    United Kingdom   21359.  1.54e7      20839        13.5      0.601
 8 Informed    United States    29212.  2.09e7      28772        20.0      1.76 
 9 Presumed    Austria          23876.  1.12e7      23798        23.5      5.84 
10 Presumed    Belgium          22500.  1.01e7      22152        21.9      3.75 
11 Presumed    Finland          21019.  1.35e7      19842        18.4      2.33 
12 Presumed    France           22603.  1.06e7      21990        16.8      2.55 
13 Presumed    Italy            21554.  7.74e6      21396        11.1     18.3  
14 Presumed    Norway           26448.  4.21e7      26218        15.4      1.23 
15 Presumed    Spain            16933   8.34e6      16416        28.1     24.6  
16 Presumed    Sweden           22415.  1.03e7      22029        13.1      3.07 
17 Presumed    Switzerland      27233   4.64e6      26304        14.2      2.92 
# ℹ 4 more variables: donors_median &lt;dbl&gt;, roads_mean &lt;dbl&gt;, roads_var &lt;dbl&gt;,
#   roads_median &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="selection-with-acrosswhere" class="slide level2">
<h2>Selection with <span class="fg-green"><strong><code>across(where())</code></strong></span></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb117" data-source-line-numbers="nil" data-code-line-numbers="4,5,6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb117-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country) <span class="sc">|&gt;</span></span>
<span id="cb117-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric),           </span>
<span id="cb117-4"><a aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="at">mean =</span> \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb117-5"><a aria-hidden="true" tabindex="-1"></a>                        <span class="at">var =</span> \(x) <span class="fu">var</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb117-6"><a aria-hidden="true" tabindex="-1"></a>                        <span class="at">median =</span> \(x) <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb117-7"><a aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb117-8"><a aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">|&gt;</span> </span>
<span id="cb117-9"><a aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># just to save slide space</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 17 × 41
# Groups:   consent_law [2]
  consent_law country   donors_mean donors_var donors_median pop_mean  pop_var
  &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Informed    Australia        10.6      1.31           10.4   18318.  690385.
2 Informed    Canada           14.0      0.564          14.0   29608. 1422648.
3 Informed    Denmark          13.1      2.16           12.9    5257.    6497.
# ℹ 14 more rows
# ℹ 34 more variables: pop_median &lt;int&gt;, pop_dens_mean &lt;dbl&gt;,
#   pop_dens_var &lt;dbl&gt;, pop_dens_median &lt;dbl&gt;, gdp_mean &lt;dbl&gt;, gdp_var &lt;dbl&gt;,
#   gdp_median &lt;int&gt;, gdp_lag_mean &lt;dbl&gt;, gdp_lag_var &lt;dbl&gt;,
#   gdp_lag_median &lt;dbl&gt;, health_mean &lt;dbl&gt;, health_var &lt;dbl&gt;,
#   health_median &lt;dbl&gt;, health_lag_mean &lt;dbl&gt;, health_lag_var &lt;dbl&gt;,
#   health_lag_median &lt;dbl&gt;, pubhealth_mean &lt;dbl&gt;, pubhealth_var &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="name-new-columns-with-.names" class="slide level2">
<h2>Name new columns with <span class="fg-green"><strong><code>.names</code></strong></span></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb119" data-source-line-numbers="nil" data-code-line-numbers="4,5,7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb119-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country) <span class="sc">|&gt;</span></span>
<span id="cb119-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric),           </span>
<span id="cb119-4"><a aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="at">mean =</span> \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb119-5"><a aria-hidden="true" tabindex="-1"></a>                        <span class="at">sd =</span> \(x) <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb119-6"><a aria-hidden="true" tabindex="-1"></a>                        <span class="at">median =</span> \(x) <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb119-7"><a aria-hidden="true" tabindex="-1"></a>                   <span class="at">.names =</span> <span class="st">"{fn}_{col}"</span> </span>
<span id="cb119-8"><a aria-hidden="true" tabindex="-1"></a>                   ) </span>
<span id="cb119-9"><a aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">|&gt;</span> </span>
<span id="cb119-10"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 17 × 41
# Groups:   consent_law [2]
  consent_law country   mean_donors sd_donors median_donors mean_pop sd_pop
  &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
1 Informed    Australia        10.6     1.14           10.4   18318.  831. 
2 Informed    Canada           14.0     0.751          14.0   29608. 1193. 
3 Informed    Denmark          13.1     1.47           12.9    5257.   80.6
# ℹ 14 more rows
# ℹ 34 more variables: median_pop &lt;int&gt;, mean_pop_dens &lt;dbl&gt;,
#   sd_pop_dens &lt;dbl&gt;, median_pop_dens &lt;dbl&gt;, mean_gdp &lt;dbl&gt;, sd_gdp &lt;dbl&gt;,
#   median_gdp &lt;int&gt;, mean_gdp_lag &lt;dbl&gt;, sd_gdp_lag &lt;dbl&gt;,
#   median_gdp_lag &lt;dbl&gt;, mean_health &lt;dbl&gt;, sd_health &lt;dbl&gt;,
#   median_health &lt;dbl&gt;, mean_health_lag &lt;dbl&gt;, sd_health_lag &lt;dbl&gt;,
#   median_health_lag &lt;dbl&gt;, mean_pubhealth &lt;dbl&gt;, sd_pubhealth &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="name-new-columns-with-.names-1" class="slide level2">
<h2>Name new columns with <span class="fg-green"><strong><code>.names</code></strong></span></h2>
<p>In tidyverse functions, arguments that begin with a “<code>.</code>” generally have it in order to avoid confusion with existing items, or are “pronouns” referring to e.g.&nbsp;“the name of the thing we’re currently talking about as we evaluate this function”.</p>
</section>
<section id="this-all-works-with-mutate-too" class="slide level2">
<h2>This all works with <span class="fg-green"><strong><code>mutate()</code></strong></span>, too</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb121" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb121-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), toupper)) <span class="sc">|&gt;</span> </span>
<span id="cb121-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.character))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 238 × 7
   country   world   opt   consent_law consent_practice consistent ccode
   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;
 1 AUSTRALIA LIBERAL IN    INFORMED    INFORMED         YES        OZ   
 2 AUSTRALIA LIBERAL IN    INFORMED    INFORMED         YES        OZ   
 3 AUSTRALIA LIBERAL IN    INFORMED    INFORMED         YES        OZ   
 4 AUSTRALIA LIBERAL IN    INFORMED    INFORMED         YES        OZ   
 5 AUSTRALIA LIBERAL IN    INFORMED    INFORMED         YES        OZ   
 6 AUSTRALIA LIBERAL IN    INFORMED    INFORMED         YES        OZ   
 7 AUSTRALIA LIBERAL IN    INFORMED    INFORMED         YES        OZ   
 8 AUSTRALIA LIBERAL IN    INFORMED    INFORMED         YES        OZ   
 9 AUSTRALIA LIBERAL IN    INFORMED    INFORMED         YES        OZ   
10 AUSTRALIA LIBERAL IN    INFORMED    INFORMED         YES        OZ   
# ℹ 228 more rows</code></pre>
</div>
</div>
</section>
<section id="arrange-rows-and-columns" class="slide level2">
<h2>Arrange rows and columns</h2>
<p>Sort rows with <span class="fg-green"><strong><code>arrange()</code></strong></span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb123" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb123-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country) <span class="sc">|&gt;</span></span>
<span id="cb123-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">donors =</span> <span class="fu">mean</span>(donors, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb123-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(donors) <span class="sc">|&gt;</span> <span class="do">##&lt;</span></span>
<span id="cb123-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 17 × 3
# Groups:   consent_law [2]
  consent_law country   donors
  &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt;
1 Informed    Australia   10.6
2 Presumed    Italy       11.1
3 Informed    Germany     13.0
4 Informed    Denmark     13.1
5 Presumed    Sweden      13.1
# ℹ 12 more rows</code></pre>
</div>
</div>
</div><div class="column right" style="width:50%;">

</div></div>
</section>
<section id="arrange-rows-and-columns-1" class="slide level2">
<h2>Arrange rows and columns</h2>
<p>Sort rows with <span class="fg-green"><strong><code>arrange()</code></strong></span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb125" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb125-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country) <span class="sc">|&gt;</span></span>
<span id="cb125-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">donors =</span> <span class="fu">mean</span>(donors, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb125-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(donors) <span class="sc">|&gt;</span> <span class="do">##&lt;</span></span>
<span id="cb125-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 17 × 3
# Groups:   consent_law [2]
  consent_law country   donors
  &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt;
1 Informed    Australia   10.6
2 Presumed    Italy       11.1
3 Informed    Germany     13.0
4 Informed    Denmark     13.1
5 Presumed    Sweden      13.1
# ℹ 12 more rows</code></pre>
</div>
</div>
</div><div class="column right" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb127" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb127-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country) <span class="sc">|&gt;</span></span>
<span id="cb127-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">donors =</span> <span class="fu">mean</span>(donors, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb127-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(donors)) <span class="sc">|&gt;</span>  <span class="do">##&lt;</span></span>
<span id="cb127-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 17 × 3
# Groups:   consent_law [2]
  consent_law country       donors
  &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;
1 Presumed    Spain           28.1
2 Presumed    Austria         23.5
3 Presumed    Belgium         21.9
4 Informed    United States   20.0
5 Informed    Ireland         19.8
# ℹ 12 more rows</code></pre>
</div>
</div>
<p>Using <span class="fg-green"><strong><code>arrange()</code></strong></span> to order rows in this way won’t respect groupings.</p>
</div></div>
</section>
<section id="more-generally" class="slide level2">
<h2>More generally …</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb129" data-source-line-numbers="nil" data-code-line-numbers="4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a aria-hidden="true" tabindex="-1"></a>organdata <span class="sc">|&gt;</span> </span>
<span id="cb129-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(consent_law, country) <span class="sc">|&gt;</span></span>
<span id="cb129-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">donors =</span> <span class="fu">mean</span>(donors, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb129-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(donors, <span class="at">n =</span> <span class="dv">5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 10 × 3
# Groups:   consent_law [2]
   consent_law country        donors
   &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;
 1 Informed    United States    20.0
 2 Informed    Ireland          19.8
 3 Informed    Canada           14.0
 4 Informed    Netherlands      13.7
 5 Informed    United Kingdom   13.5
 6 Presumed    Spain            28.1
 7 Presumed    Austria          23.5
 8 Presumed    Belgium          21.9
 9 Presumed    Finland          18.4
10 Presumed    France           16.8</code></pre>
</div>
</div>
<ul>
<li>You can see that <span class="fg-green"><strong><code>slice_max()</code></strong></span> respects grouping.</li>
<li>There’s <span class="fg-green"><strong><code>slice_min()</code></strong></span>, <span class="fg-green"><strong><code>slice_head()</code></strong></span>, <span class="fg-green"><strong><code>slice_tail()</code></strong></span>, <span class="fg-green"><strong><code>slice_sample()</code></strong></span>, and the most general one, <span class="fg-green"><strong><code>slice()</code></strong>.</span></li>
</ul>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'slow',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/kjhealy\.github\.io\/data_wrangling");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

<script src="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>